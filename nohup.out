/Users/kikuchimizuki/Desktop/LINEでカレンダー/.venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-03 06:02:11,027 - __main__ - INFO - アプリケーションを起動します
2025-05-03 06:02:11,027 - __main__ - INFO - 環境変数 LINE_CHANNEL_ACCESS_TOKEN: 設定済み
2025-05-03 06:02:11,027 - __main__ - INFO - 環境変数 LINE_CHANNEL_SECRET: 設定済み
2025-05-03 06:02:11,027 - __main__ - INFO - 環境変数 GOOGLE_CREDENTIALS: 設定済み
2025-05-03 06:02:11,029 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-03 06:02:11,030 - calendar_chat - INFO - Google Calendar APIサービスが正常に初期化されました
2025-05-03 06:02:11,153 - __main__ - INFO - アプリケーションを起動します
 * Serving Flask app 'app'
 * Debug mode: off
Address already in use
Port 5051 is in use by another program. Either identify and stop that program, or start the server with a different port.
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:42:04,902 - database - INFO - データベースを初期化しました。
2025-05-10 10:42:04,902 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:42:05,080 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:42:05,080 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:43:07,670 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:43:07,670 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '594', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'BeIZnsRpdwJAtVwZGozPsjDAxNOWyly4dn3N56K40mc=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:43:07,671 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560375930968080471","quoteToken":"ZY6SuOMGNXUgGYK778J5Ni5BNs8-WflgNjovJK-_jK54Uv0efT0aDGtm6N-WJpEW2ehblpOy9IIdw2JKi9kKcwhstWDefl4TCUemn1FVgp23JMCtOlc1M5L6T7RZJn1y6kHonB90BPXDQYGfgSC6TQ","text":"5月13日17時から博報堂打合せ"},"webhookEventId":"01JTVXRGJ18WGNY1FCY0P5BC1G","deliveryContext":{"isRedelivery":false},"timestamp":1746841387078,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"0b92e05bbc27482abbf39533576daba7","mode":"active"}]}
2025-05-10 10:43:07,675 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:43:07,675 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:43:07,676 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:43:07,676 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '594', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'BeIZnsRpdwJAtVwZGozPsjDAxNOWyly4dn3N56K40mc=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:43:07,676 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560375930968080471","quoteToken":"ZY6SuOMGNXUgGYK778J5Ni5BNs8-WflgNjovJK-_jK54Uv0efT0aDGtm6N-WJpEW2ehblpOy9IIdw2JKi9kKcwhstWDefl4TCUemn1FVgp23JMCtOlc1M5L6T7RZJn1y6kHonB90BPXDQYGfgSC6TQ","text":"5月13日17時から博報堂打合せ"},"webhookEventId":"01JTVXRGJ18WGNY1FCY0P5BC1G","deliveryContext":{"isRedelivery":false},"timestamp":1746841387078,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"0b92e05bbc27482abbf39533576daba7","mode":"active"}]}
2025-05-10 10:43:07,677 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:43:07,677 - message_parser - DEBUG - 正規化後のメッセージ: 5月13日17時から博報堂打合せ
2025-05-10 10:43:07,677 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:43:07.677484+09:00
2025-05-10 10:43:07,678 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:43:07,678 - message_parser - DEBUG - 時間抽出開始: 5月13日17時から博報堂打合せ
2025-05-10 10:43:07,678 - message_parser - DEBUG - X月Y日Z時パターン: 2025-05-13 17:00:00+09:00 から 2025-05-13 18:00:00+09:00
2025-05-10 10:43:07,679 - message_parser - DEBUG - 時間抽出開始: 5月13日17時から博報堂打合せ
2025-05-10 10:43:07,680 - message_parser - DEBUG - タイトル抽出開始: 5月13日17時から博報堂打合せ
2025-05-10 10:43:07,682 - message_parser - DEBUG - 繰り返し情報を抽出: 5月13日17時から博報堂打合せ
2025-05-10 10:43:07,683 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:43:07,683 - message_parser - DEBUG - 繰り返し情報を抽出: 5月13日17時から博報堂打合せ
2025-05-10 10:43:07,683 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:43:07,683 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': '博報堂打合せ', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 13, 17, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 13, 18, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:43:07,687 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:43:07,687 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:43:07,688 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:43:07,688 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:43:08,367 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:43:08,368 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:43:08,368 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:43:08,368 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:43:08,377 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-13T17%3A00%3A00%2B09%3A00&timeMax=2025-05-13T18%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:43:08,647 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:43:09,239 - calendar_operations - INFO - 予定を追加しました: gjskqltou1poquir7i9ju2fnd8
2025-05-10 10:43:09,247 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-13T17%3A00%3A00%2B09%3A00&timeMax=2025-05-13T18%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:43:09,530 - __main__ - DEBUG - LINEへの返信を開始: 予定「博報堂打合せ」を追加しました。

📅 2025/05/13（火）
━━━━━━━━━━
1. 博報堂打合せ
   🕘 17:00～18:00

━━━━━━━━━━
2025-05-10 10:43:09,530 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「博報堂打合せ」を追加しました。\n\n📅 2025/05/13（火）\n━━━━━━━━━━\n1. 博報堂打合せ\n   🕘 17:00～18:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:43:09,644 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:43:09,644 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:43:09,645 - __main__ - INFO - Request processed in 1.98 seconds
2025-05-10 10:43:09,645 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:43:09,645 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:43:09,646 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:43:09] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:44:30,222 - database - INFO - データベースを初期化しました。
2025-05-10 10:44:30,222 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:44:30,234 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:44:30,234 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:45:36,797 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:45:36,797 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '594', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '4KnVHxLkNP/Lo2euAuKPgUIDc8x0bd/vdkgm45RHYL0=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:45:36,798 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376181217296918","quoteToken":"oQVo4vj9rL37-oY3ZhSvLw0mfAkXe1j3wUo_ffFFxWBLmd5hoV6ArVKfrRPTS87iyjewFjlGnjTfzYItQGefYyD0lUpTCAZkOQg3g5HFguMcxDRkbsWeUnMIxQkeFFVQG5ZZWw4ccDsZON7QqncWuQ","text":"5月14日10時から電エネ定例会"},"webhookEventId":"01JTVXX251W6JA9KPAT29JYMRP","deliveryContext":{"isRedelivery":false},"timestamp":1746841536411,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"b273bf00960c4ae48dc9dcbacdee19d1","mode":"active"}]}
2025-05-10 10:45:36,802 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:45:36,802 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:45:36,802 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:45:36,803 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '594', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '4KnVHxLkNP/Lo2euAuKPgUIDc8x0bd/vdkgm45RHYL0=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:45:36,803 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376181217296918","quoteToken":"oQVo4vj9rL37-oY3ZhSvLw0mfAkXe1j3wUo_ffFFxWBLmd5hoV6ArVKfrRPTS87iyjewFjlGnjTfzYItQGefYyD0lUpTCAZkOQg3g5HFguMcxDRkbsWeUnMIxQkeFFVQG5ZZWw4ccDsZON7QqncWuQ","text":"5月14日10時から電エネ定例会"},"webhookEventId":"01JTVXX251W6JA9KPAT29JYMRP","deliveryContext":{"isRedelivery":false},"timestamp":1746841536411,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"b273bf00960c4ae48dc9dcbacdee19d1","mode":"active"}]}
2025-05-10 10:45:36,804 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:45:36,804 - message_parser - DEBUG - 正規化後のメッセージ: 5月14日10時から電えね定例会
2025-05-10 10:45:36,804 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:45:36.804162+09:00
2025-05-10 10:45:36,804 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:45:36,804 - message_parser - DEBUG - 時間抽出開始: 5月14日10時から電えね定例会
2025-05-10 10:45:36,804 - message_parser - DEBUG - X月Y日Z時パターン: 2025-05-14 10:00:00+09:00 から 2025-05-14 11:00:00+09:00
2025-05-10 10:45:36,804 - message_parser - DEBUG - 時間抽出開始: 5月14日10時から電えね定例会
2025-05-10 10:45:36,805 - message_parser - DEBUG - タイトル抽出開始: 5月14日10時から電えね定例会
2025-05-10 10:45:36,806 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日10時から電えね定例会
2025-05-10 10:45:36,807 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:45:36,807 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日10時から電えね定例会
2025-05-10 10:45:36,807 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:45:36,807 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': '電えね定例会', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 14, 10, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 14, 11, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:45:36,810 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:45:36,810 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:45:36,812 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:45:36,812 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:45:37,433 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:45:37,434 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:45:37,434 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:45:37,434 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:45:37,444 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-14T10%3A00%3A00%2B09%3A00&timeMax=2025-05-14T11%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:45:37,715 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:45:38,293 - calendar_operations - INFO - 予定を追加しました: rk3hcdkspsg0g2h2lu3h3b43tc
2025-05-10 10:45:38,301 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-14T00%3A00%3A00%2B09%3A00&timeMax=2025-05-14T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:45:38,583 - __main__ - DEBUG - LINEへの返信を開始: 予定「電えね定例会」を追加しました。

📅 2025/05/14（水）
━━━━━━━━━━
1. 電えね定例会
   🕘 10:00～11:00

━━━━━━━━━━
2025-05-10 10:45:38,584 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「電えね定例会」を追加しました。\n\n📅 2025/05/14（水）\n━━━━━━━━━━\n1. 電えね定例会\n   🕘 10:00～11:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:45:38,714 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:45:38,714 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:45:38,715 - __main__ - INFO - Request processed in 1.92 seconds
2025-05-10 10:45:38,715 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:45:38,715 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:45:38,716 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:45:38] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:46:12,968 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:46:12,968 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '634', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'KmWKNHlMmVfbiTKyKcBSbBR15PNPN11MI9lMzX3h6rc=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:46:12,969 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376241765482635","quoteToken":"kNG3X77j4Nh6oGbSQFdwZy7H60Oo8hXJMY105KCEOWaj0i4cEIDbcBGxx0E49Jj3w4vmBtovEyYrtQFVmzXTXmjZrg7XD7VXing9JJxy6gwWd7I2DwRkFCD8L9kAmu52oUaJCztpscZyKowjoz6QBQ","text":"5月14日11時\nマンションインターホン内部MTG\n1時間半\n京橋"},"webhookEventId":"01JTVXY5FKJV0XZHSQP1YFNNV0","deliveryContext":{"isRedelivery":false},"timestamp":1746841572344,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"5348edb1921c41cc92b87f34431e0e53","mode":"active"}]}
2025-05-10 10:46:12,969 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:46:12,970 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:46:12,970 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:46:12,970 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '634', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'KmWKNHlMmVfbiTKyKcBSbBR15PNPN11MI9lMzX3h6rc=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:46:12,970 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376241765482635","quoteToken":"kNG3X77j4Nh6oGbSQFdwZy7H60Oo8hXJMY105KCEOWaj0i4cEIDbcBGxx0E49Jj3w4vmBtovEyYrtQFVmzXTXmjZrg7XD7VXing9JJxy6gwWd7I2DwRkFCD8L9kAmu52oUaJCztpscZyKowjoz6QBQ","text":"5月14日11時\nマンションインターホン内部MTG\n1時間半\n京橋"},"webhookEventId":"01JTVXY5FKJV0XZHSQP1YFNNV0","deliveryContext":{"isRedelivery":false},"timestamp":1746841572344,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"5348edb1921c41cc92b87f34431e0e53","mode":"active"}]}
2025-05-10 10:46:12,971 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:46:12,971 - message_parser - DEBUG - 正規化後のメッセージ: 5月14日11時
まんしょんいんたｰほん内部MTG
1時間半
京橋
2025-05-10 10:46:12,971 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:46:12.971454+09:00
2025-05-10 10:46:12,971 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:46:12,972 - message_parser - DEBUG - 時間抽出開始: 5月14日11時
まんしょんいんたｰほん内部MTG
1時間半
京橋
2025-05-10 10:46:12,972 - message_parser - DEBUG - X月Y日Z時パターン: 2025-05-14 11:00:00+09:00 から 2025-05-14 12:30:00+09:00
2025-05-10 10:46:12,972 - message_parser - DEBUG - 時間抽出開始: 5月14日11時
まんしょんいんたｰほん内部MTG
1時間半
京橋
2025-05-10 10:46:12,972 - message_parser - DEBUG - タイトル抽出開始: 5月14日11時
まんしょんいんたｰほん内部MTG
1時間半
京橋
2025-05-10 10:46:12,972 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日11時
まんしょんいんたｰほん内部MTG
1時間半
京橋
2025-05-10 10:46:12,973 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:46:12,973 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日11時
まんしょんいんたｰほん内部MTG
1時間半
京橋
2025-05-10 10:46:12,973 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:46:12,973 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'まんしょんいんたｰほん内部MTG\n1間半\n京橋', 'location': '京橋', 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 14, 11, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 14, 12, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:46:12,977 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:46:12,977 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:46:12,978 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:46:12,978 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:46:13,721 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:46:13,722 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:46:13,722 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:46:13,724 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:46:13,729 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-14T11%3A00%3A00%2B09%3A00&timeMax=2025-05-14T12%3A30%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:46:14,004 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:46:14,539 - calendar_operations - INFO - 予定を追加しました: 2hvrs3jrfvkpoug8ditrv5c794
2025-05-10 10:46:14,547 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-14T00%3A00%3A00%2B09%3A00&timeMax=2025-05-14T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:46:14,952 - __main__ - DEBUG - LINEへの返信を開始: 予定「まんしょんいんたｰほん内部MTG
1間半
京橋」を追加しました。

📅 2025/05/14（水）
━━━━━━━━━━
1. 電えね定例会
   🕘 10:00～11:00

2. まんしょんいんたｰほん内部MTG
1間半
京橋
   🕘 11:00～12:30
   📍 京橋

━━━━━━━━━━
2025-05-10 10:46:14,953 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「まんしょんいんたｰほん内部MTG\n1間半\n京橋」を追加しました。\n\n📅 2025/05/14（水）\n━━━━━━━━━━\n1. 電えね定例会\n   🕘 10:00～11:00\n\n2. まんしょんいんたｰほん内部MTG\n1間半\n京橋\n   🕘 11:00～12:30\n   📍 京橋\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:46:15,017 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:46:15,017 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:46:15,018 - __main__ - INFO - Request processed in 2.05 seconds
2025-05-10 10:46:15,018 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:46:15,018 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:46:15,019 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:46:15] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:48:14,501 - database - INFO - データベースを初期化しました。
2025-05-10 10:48:14,501 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:48:14,658 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:48:14,658 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:49:23,115 - database - INFO - データベースを初期化しました。
2025-05-10 10:49:23,115 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:49:23,120 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:49:23,120 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:50:20,995 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:50:20,996 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '620', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '5jDRsUFQl9vZ9qdbtEfVsdIuwuicLmmY9hsEy3l0pQw=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:50:20,996 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376657907548714","quoteToken":"sMVINjv99tN_RSZxckd2RKFj2aBMNLWXTFG5ts1bBEmd4F949YSRz41bA28OZ3OrDbjtxyBSGyCXvyFP4POL0IYfDwZ2udR2ZT0zBxdtNOLlSh6d0HoO5PsZ4_yHTuJiPdn3SdDi7i8DouhO4Gopgg","text":"5月15日13時\nコミュ室定例会\n1005会議室\n2時間半"},"webhookEventId":"01JTVY5QP9SATJDAEM47CVE9BZ","deliveryContext":{"isRedelivery":false},"timestamp":1746841820367,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1c46c94eec26467c866d59944b2cc896","mode":"active"}]}
2025-05-10 10:50:21,001 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:50:21,002 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:50:21,002 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:50:21,002 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '620', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '5jDRsUFQl9vZ9qdbtEfVsdIuwuicLmmY9hsEy3l0pQw=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:50:21,002 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376657907548714","quoteToken":"sMVINjv99tN_RSZxckd2RKFj2aBMNLWXTFG5ts1bBEmd4F949YSRz41bA28OZ3OrDbjtxyBSGyCXvyFP4POL0IYfDwZ2udR2ZT0zBxdtNOLlSh6d0HoO5PsZ4_yHTuJiPdn3SdDi7i8DouhO4Gopgg","text":"5月15日13時\nコミュ室定例会\n1005会議室\n2時間半"},"webhookEventId":"01JTVY5QP9SATJDAEM47CVE9BZ","deliveryContext":{"isRedelivery":false},"timestamp":1746841820367,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1c46c94eec26467c866d59944b2cc896","mode":"active"}]}
2025-05-10 10:50:21,003 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:50:21,004 - message_parser - DEBUG - 正規化後のメッセージ: 5月15日13時
こみゅ室定例会
1005会議室
2時間半
2025-05-10 10:50:21,004 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:50:21.003963+09:00
2025-05-10 10:50:21,004 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:50:21,004 - message_parser - DEBUG - 時間抽出開始: 5月15日13時
こみゅ室定例会
1005会議室
2時間半
2025-05-10 10:50:21,005 - message_parser - DEBUG - X月Y日Z時パターン: 2025-05-15 13:00:00+09:00 から 2025-05-15 15:30:00+09:00
2025-05-10 10:50:21,005 - message_parser - DEBUG - 時間抽出開始: 5月15日13時
こみゅ室定例会
1005会議室
2時間半
2025-05-10 10:50:21,007 - message_parser - DEBUG - タイトル抽出開始: 5月15日13時
こみゅ室定例会
1005会議室
2時間半
2025-05-10 10:50:21,007 - message_parser - DEBUG - 繰り返し情報を抽出: 5月15日13時
こみゅ室定例会
1005会議室
2時間半
2025-05-10 10:50:21,008 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:50:21,008 - message_parser - DEBUG - 繰り返し情報を抽出: 5月15日13時
こみゅ室定例会
1005会議室
2時間半
2025-05-10 10:50:21,008 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:50:21,008 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'こみゅ室定例会', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 15, 13, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 15, 15, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:50:21,012 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:50:21,012 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:50:21,013 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:50:21,014 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:50:21,644 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:50:21,645 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:50:21,645 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:50:21,645 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:50:21,654 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-15T13%3A00%3A00%2B09%3A00&timeMax=2025-05-15T15%3A30%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:50:21,932 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:50:22,453 - calendar_operations - INFO - 予定を追加しました: c4aj6c2nd5hgi0ruujca02kkg8
2025-05-10 10:50:22,455 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-15T00%3A00%3A00%2B09%3A00&timeMax=2025-05-15T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:50:22,722 - __main__ - DEBUG - LINEへの返信を開始: 予定「こみゅ室定例会」を追加しました。

📅 2025/05/15（木）
━━━━━━━━━━
1. こみゅ室定例会
   🕘 13:00～15:30

━━━━━━━━━━
2025-05-10 10:50:22,722 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「こみゅ室定例会」を追加しました。\n\n📅 2025/05/15（木）\n━━━━━━━━━━\n1. こみゅ室定例会\n   🕘 13:00～15:30\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:50:22,828 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:50:22,828 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:50:22,829 - __main__ - INFO - Request processed in 1.83 seconds
2025-05-10 10:50:22,829 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:50:22,829 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:50:22,829 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:50:22] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:52:32,450 - database - INFO - データベースを初期化しました。
2025-05-10 10:52:32,450 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:52:32,680 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:52:32,680 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:53:00,292 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:53:00,292 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '+Z0Z3/ojxFdzfqE2Aw6iQO31FxeHbR7hEkp0iyM1oIY=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:53:00,292 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376925722247239","quoteToken":"4OyRYlSlL-L_flvz_8T7EzgOnKcqFUWOy8N9B9_lyUQ1hvkQ-ka7k0mm0NUvCs95funj1tO5_jjxAi8w2PuAlYMbzFW0qcEMaaQ2hvHmxK3ZqlCLOru8zdLbNvrS9DeCrXWKGS8CHxA8eRN_shFdcA","text":"5月15日16時半から令和電気設備運動"},"webhookEventId":"01JTVYAK8SMXQVZ2FQGHYBZFAB","deliveryContext":{"isRedelivery":false},"timestamp":1746841980110,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"200e538f7a024bf0a66b6ecd5af5e6f0","mode":"active"}]}
2025-05-10 10:53:00,297 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:53:00,298 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:53:00,298 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:53:00,299 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '+Z0Z3/ojxFdzfqE2Aw6iQO31FxeHbR7hEkp0iyM1oIY=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:53:00,299 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560376925722247239","quoteToken":"4OyRYlSlL-L_flvz_8T7EzgOnKcqFUWOy8N9B9_lyUQ1hvkQ-ka7k0mm0NUvCs95funj1tO5_jjxAi8w2PuAlYMbzFW0qcEMaaQ2hvHmxK3ZqlCLOru8zdLbNvrS9DeCrXWKGS8CHxA8eRN_shFdcA","text":"5月15日16時半から令和電気設備運動"},"webhookEventId":"01JTVYAK8SMXQVZ2FQGHYBZFAB","deliveryContext":{"isRedelivery":false},"timestamp":1746841980110,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"200e538f7a024bf0a66b6ecd5af5e6f0","mode":"active"}]}
2025-05-10 10:53:00,300 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:53:00,300 - message_parser - DEBUG - 正規化後のメッセージ: 5月15日16時半から令和電気設備運動
2025-05-10 10:53:00,300 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:53:00.300343+09:00
2025-05-10 10:53:00,300 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:53:00,301 - message_parser - DEBUG - 時間抽出開始: 5月15日16時半から令和電気設備運動
2025-05-10 10:53:00,301 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-15 16:30:00+09:00 から 2025-05-15 17:30:00+09:00
2025-05-10 10:53:00,301 - message_parser - DEBUG - 時間抽出開始: 5月15日16時半から令和電気設備運動
2025-05-10 10:53:00,303 - message_parser - DEBUG - タイトル抽出開始: 5月15日16時半から令和電気設備運動
2025-05-10 10:53:00,303 - message_parser - DEBUG - 繰り返し情報を抽出: 5月15日16時半から令和電気設備運動
2025-05-10 10:53:00,304 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:53:00,304 - message_parser - DEBUG - 繰り返し情報を抽出: 5月15日16時半から令和電気設備運動
2025-05-10 10:53:00,304 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:53:00,304 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 15, 16, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 15, 17, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:53:00,311 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:53:00,311 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:53:00,313 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:53:00,313 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:53:00,914 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:53:00,915 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:53:00,915 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:53:00,915 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:53:00,925 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-15T16%3A30%3A00%2B09%3A00&timeMax=2025-05-15T17%3A30%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:53:01,208 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:53:01,793 - calendar_operations - INFO - 予定を追加しました: l2cp6s2215gd9q91jlpv1m83ho
2025-05-10 10:53:01,802 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-15T00%3A00%3A00%2B09%3A00&timeMax=2025-05-15T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:53:02,119 - __main__ - DEBUG - LINEへの返信を開始: 予定「令和電気設備運動」を追加しました。

📅 2025/05/15（木）
━━━━━━━━━━
1. こみゅ室定例会
   🕘 13:00～15:30

2. 令和電気設備運動
   🕘 16:30～17:30

━━━━━━━━━━
2025-05-10 10:53:02,119 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「令和電気設備運動」を追加しました。\n\n📅 2025/05/15（木）\n━━━━━━━━━━\n1. こみゅ室定例会\n   🕘 13:00～15:30\n\n2. 令和電気設備運動\n   🕘 16:30～17:30\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:53:02,255 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:53:02,255 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:53:02,256 - __main__ - INFO - Request processed in 1.96 seconds
2025-05-10 10:53:02,256 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:53:02,256 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:53:02,256 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:53:02] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:53:49,019 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:53:49,020 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '600', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'EKVcYIjPGfTDrde9v1w1WVmP7qFFEPsWV6B1nON2eMQ=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:53:49,020 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377007125299680","quoteToken":"aBO3ZdHnAKn0lQeNX3nDI33XYUq8hbBOdJyne8hpykuK8pMxjzfOsrPXu79JYgLWEiU7yYSUoSbL3IKU362hozcQ4RRk4mPpoZC728B5El5dYpiAiSupbm89FJqeAmjfSiqETA3iMfj2CH5yAaAwxg","text":"5月19日13時から販促デジタル部MTG"},"webhookEventId":"01JTVYC2TDARBJ5MY8NTZYV8XM","deliveryContext":{"isRedelivery":false},"timestamp":1746842028640,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"b5411db4d1234cea9c9d132589160c52","mode":"active"}]}
2025-05-10 10:53:49,020 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:53:49,021 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:53:49,021 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:53:49,022 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '600', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'EKVcYIjPGfTDrde9v1w1WVmP7qFFEPsWV6B1nON2eMQ=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:53:49,022 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377007125299680","quoteToken":"aBO3ZdHnAKn0lQeNX3nDI33XYUq8hbBOdJyne8hpykuK8pMxjzfOsrPXu79JYgLWEiU7yYSUoSbL3IKU362hozcQ4RRk4mPpoZC728B5El5dYpiAiSupbm89FJqeAmjfSiqETA3iMfj2CH5yAaAwxg","text":"5月19日13時から販促デジタル部MTG"},"webhookEventId":"01JTVYC2TDARBJ5MY8NTZYV8XM","deliveryContext":{"isRedelivery":false},"timestamp":1746842028640,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"b5411db4d1234cea9c9d132589160c52","mode":"active"}]}
2025-05-10 10:53:49,022 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:53:49,022 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時から販促でじたる部MTG
2025-05-10 10:53:49,022 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:53:49.022779+09:00
2025-05-10 10:53:49,023 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:53:49,023 - message_parser - DEBUG - 時間抽出開始: 5月19日13時から販促でじたる部MTG
2025-05-10 10:53:49,023 - message_parser - DEBUG - X月Y日Z時パターン: 2025-05-19 13:00:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 10:53:49,023 - message_parser - DEBUG - 時間抽出開始: 5月19日13時から販促でじたる部MTG
2025-05-10 10:53:49,023 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時から販促でじたる部MTG
2025-05-10 10:53:49,023 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時から販促でじたる部MTG
2025-05-10 10:53:49,023 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:53:49,023 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時から販促でじたる部MTG
2025-05-10 10:53:49,023 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:53:49,023 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:53:49,026 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:53:49,026 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:53:49,028 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:53:49,028 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:53:49,631 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:53:49,632 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:53:49,632 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:53:49,632 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:53:49,642 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A00%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:53:49,917 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:53:50,470 - calendar_operations - INFO - 予定を追加しました: 3qga9dvt88s6lp67p58063hrg0
2025-05-10 10:53:50,475 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T00%3A00%3A00%2B09%3A00&timeMax=2025-05-19T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:53:50,748 - __main__ - DEBUG - LINEへの返信を開始: 予定「販促デジタル部MTG」を追加しました。

📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

━━━━━━━━━━
2025-05-10 10:53:50,748 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「販促デジタル部MTG」を追加しました。\n\n📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:53:50,816 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:53:50,816 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:53:50,817 - __main__ - INFO - Request processed in 1.80 seconds
2025-05-10 10:53:50,817 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:53:50,817 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:53:50,817 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:53:50] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:54:22,182 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:54:22,182 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'LRs+UBrru+F8xC9OVfJgXsj2ZBSSmqboJ2dSi5AX5R0=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:54:22,182 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377062322339878","quoteToken":"gmgmyD4bvUepmITKdIZBcCWMkDiiB5VifR08jr9hWvzno1Qhk2umnkI3Z9ttgtlXCoLGtdTfvWE1Ir32T1Pm13JXuC56DkNC2s7POoPH9mLO_3Ajlb5PawsxWLGFpwWdsE3FxFb2sLItZ5QTpkM2lw","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYD34YHEC2CFGZZZ92KZW6","deliveryContext":{"isRedelivery":false},"timestamp":1746842061475,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"a6bd5bb11678451bb18c9af667af7704","mode":"active"}]}
2025-05-10 10:54:22,183 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:54:22,183 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:54:22,184 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:54:22,184 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'LRs+UBrru+F8xC9OVfJgXsj2ZBSSmqboJ2dSi5AX5R0=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:54:22,184 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377062322339878","quoteToken":"gmgmyD4bvUepmITKdIZBcCWMkDiiB5VifR08jr9hWvzno1Qhk2umnkI3Z9ttgtlXCoLGtdTfvWE1Ir32T1Pm13JXuC56DkNC2s7POoPH9mLO_3Ajlb5PawsxWLGFpwWdsE3FxFb2sLItZ5QTpkM2lw","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYD34YHEC2CFGZZZ92KZW6","deliveryContext":{"isRedelivery":false},"timestamp":1746842061475,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"a6bd5bb11678451bb18c9af667af7704","mode":"active"}]}
2025-05-10 10:54:22,185 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:54:22,186 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:54:22,186 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:54:22.185979+09:00
2025-05-10 10:54:22,186 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:54:22,186 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:54:22,186 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 10:54:22,186 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:54:22,187 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:54:22,187 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:54:22,187 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:54:22,187 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:54:22,188 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:54:22,188 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:54:22,192 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:54:22,193 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:54:22,194 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:54:22,194 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:54:22,794 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:54:22,795 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:54:22,795 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:54:22,796 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:54:22,805 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:54:23,103 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 10:54:23,104 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 10:54:23,200 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:54:23,206 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:54:23,227 - __main__ - INFO - Request processed in 1.05 seconds
2025-05-10 10:54:23,234 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:54:23,234 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:54:23,234 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:54:23] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:54:28,749 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:54:28,750 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'oY2CRkM3XCwH98j/D2i6DLQQ4AdGm0Rz2l/5Yvd8LPc=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:54:28,750 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377073563861300","quoteToken":"7pp35wME5suX_o_6lUScZ59kxm5IiBh_FDPsqjLkEp-IW2mRUKFlulyjkqRWDHcYMeqatQ4qXeHmIpbCdOaMtwhZiOshqQ1MsGE-OvvG645J5QP2bIs8BhvMkuUZH-jA_MCs0eM1m8W-_cZajvZpbw","text":"はい"},"webhookEventId":"01JTVYD9NK982G434TKGTVSQ5W","deliveryContext":{"isRedelivery":false},"timestamp":1746842068177,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"3e3ad05f7e4643179c73311ae623a11a","mode":"active"}]}
2025-05-10 10:54:28,751 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:54:28,752 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:54:28,752 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:54:28,752 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'oY2CRkM3XCwH98j/D2i6DLQQ4AdGm0Rz2l/5Yvd8LPc=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:54:28,752 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377073563861300","quoteToken":"7pp35wME5suX_o_6lUScZ59kxm5IiBh_FDPsqjLkEp-IW2mRUKFlulyjkqRWDHcYMeqatQ4qXeHmIpbCdOaMtwhZiOshqQ1MsGE-OvvG645J5QP2bIs8BhvMkuUZH-jA_MCs0eM1m8W-_cZajvZpbw","text":"はい"},"webhookEventId":"01JTVYD9NK982G434TKGTVSQ5W","deliveryContext":{"isRedelivery":false},"timestamp":1746842068177,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"3e3ad05f7e4643179c73311ae623a11a","mode":"active"}]}
2025-05-10 10:54:28,753 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:54:28,753 - message_parser - DEBUG - 正規化後のメッセージ: はい
2025-05-10 10:54:28,754 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:54:28.753826+09:00
2025-05-10 10:54:28,754 - message_parser - DEBUG - メッセージ解析結果: None
2025-05-10 10:54:28,754 - message_parser - DEBUG - 時間抽出開始: はい
2025-05-10 10:54:28,756 - message_parser - DEBUG - 日付のみの時間情報: 2025-05-10 00:00:00+09:00 から 2025-05-10 23:59:00+09:00
2025-05-10 10:54:28,756 - message_parser - DEBUG - 時間抽出開始: はい
2025-05-10 10:54:28,757 - message_parser - DEBUG - タイトル抽出開始: はい
2025-05-10 10:54:28,757 - message_parser - DEBUG - 繰り返し情報を抽出: はい
2025-05-10 10:54:28,757 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:54:28,757 - message_parser - DEBUG - 繰り返し情報を抽出: はい
2025-05-10 10:54:28,758 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:54:28,758 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'はい', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 10, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 10, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 10:54:28,774 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:54:28,774 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:54:28,775 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:54:28,775 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:54:29,445 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:54:29,446 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:54:29,446 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:54:29,447 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:54:29,456 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-10T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:54:29,736 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 10:54:30,287 - calendar_operations - INFO - 予定を追加しました: m4okl293gl5b4gs2unjlvbq79k
2025-05-10 10:54:30,294 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-10T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:54:30,568 - __main__ - DEBUG - LINEへの返信を開始: 予定「はい」を追加しました。

📅 2025/05/10（土）
━━━━━━━━━━
1. はい
   🕘 00:00～23:59

━━━━━━━━━━
2025-05-10 10:54:30,569 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「はい」を追加しました。\n\n📅 2025/05/10（土）\n━━━━━━━━━━\n1. はい\n   🕘 00:00～23:59\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 10:54:30,645 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:54:30,645 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:54:30,646 - __main__ - INFO - Request processed in 1.90 seconds
2025-05-10 10:54:30,646 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:54:30,646 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:54:30,646 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:54:30] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:55:59,835 - database - INFO - データベースを初期化しました。
2025-05-10 10:55:59,835 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:56:00,009 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:56:00,009 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:56:16,211 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:56:16,211 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'gCZ0s9yjFys0N2VyNPytvix9dTT+HJT3F8sGizpI87A=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:56:16,212 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377254488572283","quoteToken":"Uoj7kl-URCEJqUA4AmkTlGfTDQ9M0vItWa-zbJaueCoXHRrsRN2ThL33R0KfDlRAOb6-gsayu1LCwVgA4lP0G5MExrDQqgBvTp3PTCzrObJhDgmcjOrN4X5DgUHl69PSEIHRRWNJ_iJL-EEnrVKOLQ","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYGJJBC0RAS2B50X24EE5A","deliveryContext":{"isRedelivery":false},"timestamp":1746842175953,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"c2d5605627574703a2752a0dcbd7532e","mode":"active"}]}
2025-05-10 10:56:16,217 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:56:16,217 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:56:16,218 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:56:16,218 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'gCZ0s9yjFys0N2VyNPytvix9dTT+HJT3F8sGizpI87A=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:56:16,218 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377254488572283","quoteToken":"Uoj7kl-URCEJqUA4AmkTlGfTDQ9M0vItWa-zbJaueCoXHRrsRN2ThL33R0KfDlRAOb6-gsayu1LCwVgA4lP0G5MExrDQqgBvTp3PTCzrObJhDgmcjOrN4X5DgUHl69PSEIHRRWNJ_iJL-EEnrVKOLQ","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYGJJBC0RAS2B50X24EE5A","deliveryContext":{"isRedelivery":false},"timestamp":1746842175953,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"c2d5605627574703a2752a0dcbd7532e","mode":"active"}]}
2025-05-10 10:56:16,219 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:56:16,220 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:56:16,220 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:56:16.220170+09:00
2025-05-10 10:56:16,221 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:56:16,221 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:56:16,222 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 10:56:16,222 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:56:16,224 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:56:16,225 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:56:16,225 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:56:16,225 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:56:16,225 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:56:16,226 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:56:16,232 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:56:16,232 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:56:16,233 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:56:16,233 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:56:16,810 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:56:16,811 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:56:16,811 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:56:16,811 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:56:16,820 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:56:17,088 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 10:56:17,088 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 10:56:17,236 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:56:17,237 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:56:17,238 - __main__ - INFO - Request processed in 1.03 seconds
2025-05-10 10:56:17,238 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:56:17,238 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:56:17,238 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:56:17] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:56:21,004 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:56:21,005 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'CsVKR2BgHiOm1NZfKfkbBXyiZmy2kEYd3wb43OyhKpM=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:56:21,005 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377261954433466","quoteToken":"WKDigtAZtaGyM1IEIXVgN4Rib4uSBs7xL7wzB-QsDiX186RRdRgYVSKvhVnXlk6UKxNgcTzM1SGC6GZYezfA3u1MoHKCUfw2DFcegvNhgyg_hFotgKirqTsZeC_E8VALHNS6Dh8FdoxwwRtK4jHiyw","text":"はい"},"webhookEventId":"01JTVYGQ9HQQJ2NXVQSAT5Q2TC","deliveryContext":{"isRedelivery":false},"timestamp":1746842180406,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"acdc735c8a38487f8f3a1bc6d84ae270","mode":"active"}]}
2025-05-10 10:56:21,005 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:56:21,006 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:56:21,006 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:56:21,006 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'CsVKR2BgHiOm1NZfKfkbBXyiZmy2kEYd3wb43OyhKpM=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:56:21,007 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377261954433466","quoteToken":"WKDigtAZtaGyM1IEIXVgN4Rib4uSBs7xL7wzB-QsDiX186RRdRgYVSKvhVnXlk6UKxNgcTzM1SGC6GZYezfA3u1MoHKCUfw2DFcegvNhgyg_hFotgKirqTsZeC_E8VALHNS6Dh8FdoxwwRtK4jHiyw","text":"はい"},"webhookEventId":"01JTVYGQ9HQQJ2NXVQSAT5Q2TC","deliveryContext":{"isRedelivery":false},"timestamp":1746842180406,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"acdc735c8a38487f8f3a1bc6d84ae270","mode":"active"}]}
2025-05-10 10:56:21,008 - __main__ - DEBUG - LINEへの返信を開始: 確認中の予定がありません。
2025-05-10 10:56:21,008 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='確認中の予定がありません。', emojis=None, quote_token=None)]
2025-05-10 10:56:21,078 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:56:21,078 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:56:21,078 - __main__ - INFO - Request processed in 0.07 seconds
2025-05-10 10:56:21,078 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:56:21,079 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:56:21,079 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:56:21] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:57:45,335 - database - INFO - データベースを初期化しました。
2025-05-10 10:57:45,335 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:57:45,340 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:57:45,340 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:57:55,761 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:57:55,761 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'G2+YK4bRPz0QQ6gRffjB6Wnym6JYH3OtEIF+KqPav9U=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:57:55,762 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377421573390695","quoteToken":"ZIyA5kv-ny7VO0GupRWhloSp_ojSAmeFc6Ab2ThzU_5qNubS7Oosy-YXIJgV81C749p-6xJhJV5sWfQC9uM9x5tBklFOTNkrihKX9urmepPRxXSj_ZRjiEdXRtImt12VwFMyu1tHcKvv-Sy1vDEexA","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYKKW540AK8NP2HK6424DG","deliveryContext":{"isRedelivery":false},"timestamp":1746842275546,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"6b1b01a3b8c444f88f3d351e806aba05","mode":"active"}]}
2025-05-10 10:57:55,766 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:57:55,767 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:57:55,768 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:57:55,768 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'G2+YK4bRPz0QQ6gRffjB6Wnym6JYH3OtEIF+KqPav9U=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:57:55,768 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377421573390695","quoteToken":"ZIyA5kv-ny7VO0GupRWhloSp_ojSAmeFc6Ab2ThzU_5qNubS7Oosy-YXIJgV81C749p-6xJhJV5sWfQC9uM9x5tBklFOTNkrihKX9urmepPRxXSj_ZRjiEdXRtImt12VwFMyu1tHcKvv-Sy1vDEexA","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYKKW540AK8NP2HK6424DG","deliveryContext":{"isRedelivery":false},"timestamp":1746842275546,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"6b1b01a3b8c444f88f3d351e806aba05","mode":"active"}]}
2025-05-10 10:57:55,769 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:57:55,770 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:57:55,770 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:57:55.770024+09:00
2025-05-10 10:57:55,770 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:57:55,770 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:57:55,771 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 10:57:55,771 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:57:55,774 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:57:55,774 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:57:55,775 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:57:55,775 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:57:55,775 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:57:55,775 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:57:55,780 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:57:55,781 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:57:55,782 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:57:55,782 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:57:56,381 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:57:56,382 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:57:56,382 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:57:56,383 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:57:56,390 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:57:56,710 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 10:57:56,711 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 10:57:56,851 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:57:56,851 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:57:56,852 - __main__ - INFO - Request processed in 1.09 seconds
2025-05-10 10:57:56,852 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:57:56,852 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:57:56,852 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:57:56] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:57:59,127 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:57:59,128 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'ttKRCCz6ax4+XEetrsAsluL5Vake1XXouEuhNR3Jgqw=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:57:59,128 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377427293896760","quoteToken":"df9HhbPGOz7lEREysrniBf3KP58VZlP7u5aoHcYHxDK2_qtBBKT_z5vkQxGfJxBqWCs8hkifOTntnTrzssLNK1SzhjEEQl7sYmGND4eQVJhGkOliUZLL8VPvtGCRqJ3CzT_KiG1RY_BYYca1wjnCgg","text":"はい"},"webhookEventId":"01JTVYKQ3BC70NW5S5RNRA2TF1","deliveryContext":{"isRedelivery":false},"timestamp":1746842278950,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"27678be029444f64af477addd22b09e8","mode":"active"}]}
2025-05-10 10:57:59,128 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:57:59,129 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:57:59,129 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:57:59,129 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'ttKRCCz6ax4+XEetrsAsluL5Vake1XXouEuhNR3Jgqw=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:57:59,129 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377427293896760","quoteToken":"df9HhbPGOz7lEREysrniBf3KP58VZlP7u5aoHcYHxDK2_qtBBKT_z5vkQxGfJxBqWCs8hkifOTntnTrzssLNK1SzhjEEQl7sYmGND4eQVJhGkOliUZLL8VPvtGCRqJ3CzT_KiG1RY_BYYca1wjnCgg","text":"はい"},"webhookEventId":"01JTVYKQ3BC70NW5S5RNRA2TF1","deliveryContext":{"isRedelivery":false},"timestamp":1746842278950,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"27678be029444f64af477addd22b09e8","mode":"active"}]}
2025-05-10 10:57:59,134 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:57:59,134 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:57:59,136 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:57:59,136 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:57:59,766 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:57:59,767 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:57:59,767 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:57:59,773 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:58:00,053 - __main__ - DEBUG - LINEへの返信を開始: 予定の追加に失敗しました。
2025-05-10 10:58:00,053 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定の追加に失敗しました。', emojis=None, quote_token=None)]
2025-05-10 10:58:00,108 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:58:00,108 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:58:00,109 - __main__ - INFO - Request processed in 0.98 seconds
2025-05-10 10:58:00,109 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:58:00,109 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:58:00,109 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:58:00] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 10:59:24,041 - database - INFO - データベースを初期化しました。
2025-05-10 10:59:24,041 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 10:59:24,125 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 10:59:24,125 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 10:59:36,361 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:59:36,362 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'J8Vfio86m3T7C6uKpt6LGpx2pPZ6pn5oW81NRFK/2go=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:59:36,362 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377589730902157","quoteToken":"LPNmZFQc5n2JAYZ9R4T3lsSSwGIg5qK8ljqkTfDYSGF_WbIxVC25JZ7E0ldhB8t_e-D9odGRSDacJRkNMUF17fGrykSC-clJsOcfBx90wd6ySjO3FI_zoi1IcmBRzcPYlR0njYBuEjIRYszj2JJcIw","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYPP1T84RPEH18127R4T8T","deliveryContext":{"isRedelivery":false},"timestamp":1746842375771,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"51612c3885694db6b7b68281bafb9820","mode":"active"}]}
2025-05-10 10:59:36,366 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:59:36,367 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:59:36,368 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:59:36,368 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'J8Vfio86m3T7C6uKpt6LGpx2pPZ6pn5oW81NRFK/2go=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:59:36,368 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377589730902157","quoteToken":"LPNmZFQc5n2JAYZ9R4T3lsSSwGIg5qK8ljqkTfDYSGF_WbIxVC25JZ7E0ldhB8t_e-D9odGRSDacJRkNMUF17fGrykSC-clJsOcfBx90wd6ySjO3FI_zoi1IcmBRzcPYlR0njYBuEjIRYszj2JJcIw","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYPP1T84RPEH18127R4T8T","deliveryContext":{"isRedelivery":false},"timestamp":1746842375771,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"51612c3885694db6b7b68281bafb9820","mode":"active"}]}
2025-05-10 10:59:36,369 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 10:59:36,369 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:59:36,369 - message_parser - DEBUG - 現在時刻: 2025-05-10 10:59:36.369612+09:00
2025-05-10 10:59:36,370 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 10:59:36,370 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:59:36,370 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 10:59:36,371 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:59:36,373 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:59:36,373 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:59:36,374 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:59:36,374 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 10:59:36,374 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 10:59:36,374 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 10:59:36,378 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:59:36,378 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:59:36,380 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:59:36,380 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:59:36,955 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:59:36,955 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:59:36,956 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:59:36,956 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 10:59:36,964 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:59:37,235 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 10:59:37,236 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 10:59:37,347 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:59:37,347 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:59:37,348 - __main__ - INFO - Request processed in 0.99 seconds
2025-05-10 10:59:37,348 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:59:37,348 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:59:37,349 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:59:37] "POST /callback HTTP/1.1" 200 -
2025-05-10 10:59:39,641 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:59:39,641 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'o2OT4tPBgH7TcJcgzvd8Rf9dPzYOkhZasaFLtFu2xUg=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:59:39,641 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377595737669838","quoteToken":"plR0FfaFfJCnYBS3TDYp6_yazfqTLraVjVkjOmudxGQfOnDVI1RK7WA2AAjoN0Mb25AGzWEkiuiprDTCnwC0lEQYJ-JZwL4GYGmaga8Cc9F0hT4rdqGGNvdf_g4o5tvZAA65GLvQkv4oGwNEkz-TkA","text":"はい"},"webhookEventId":"01JTVYPS99WY7CVS6H2222DPA7","deliveryContext":{"isRedelivery":false},"timestamp":1746842379457,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"df604716d5494c51aa3710a96a6c98c5","mode":"active"}]}
2025-05-10 10:59:39,642 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 10:59:39,642 - __main__ - INFO - Webhookの処理を開始
2025-05-10 10:59:39,643 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 10:59:39,643 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'o2OT4tPBgH7TcJcgzvd8Rf9dPzYOkhZasaFLtFu2xUg=', 'Accept-Encoding': 'gzip'}
2025-05-10 10:59:39,643 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377595737669838","quoteToken":"plR0FfaFfJCnYBS3TDYp6_yazfqTLraVjVkjOmudxGQfOnDVI1RK7WA2AAjoN0Mb25AGzWEkiuiprDTCnwC0lEQYJ-JZwL4GYGmaga8Cc9F0hT4rdqGGNvdf_g4o5tvZAA65GLvQkv4oGwNEkz-TkA","text":"はい"},"webhookEventId":"01JTVYPS99WY7CVS6H2222DPA7","deliveryContext":{"isRedelivery":false},"timestamp":1746842379457,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"df604716d5494c51aa3710a96a6c98c5","mode":"active"}]}
2025-05-10 10:59:39,644 - __main__ - DEBUG - pending_event: {'user_id': 'U6a99e85de7d2922e21b6769f9c98fd5b', 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None}
2025-05-10 10:59:39,649 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 10:59:39,649 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 10:59:39,651 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 10:59:39,651 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 10:59:40,248 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 10:59:40,249 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 10:59:40,249 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 10:59:40,258 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 10:59:40,545 - __main__ - DEBUG - LINEへの返信を開始: 予定の追加に失敗しました: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 10:59:40,546 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定の追加に失敗しました: ⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 10:59:40,600 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 10:59:40,600 - __main__ - INFO - Webhookの処理が完了
2025-05-10 10:59:40,601 - __main__ - INFO - Request processed in 0.96 seconds
2025-05-10 10:59:40,601 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 10:59:40,601 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 10:59:40,601 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 10:59:40] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:01:22,338 - database - INFO - データベースを初期化しました。
2025-05-10 11:01:22,339 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:01:22,344 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:01:22,344 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:01:31,711 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:01:31,711 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'HqzHrLIoIq5ey8rSFPQmVZ8ruuGij2C3rofSlk1qYXM=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:01:31,711 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377783021469958","quoteToken":"qb0M3m4lsbIKB0Je2jRRMILyxN6GcfzvmxhCSmcgFAYf0YcdgwkVDK8mWO_ZA6h0_-wKXzgnFU591_IRIzsfT2cKlGlqx2V2d9uBU1G-UhF8C_KmR1tUVl8812ae-7xI2JHVMZRjqyt-DtR9A4p1Zg","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYT6GQ03VFAS06GTK4SGJY","deliveryContext":{"isRedelivery":false},"timestamp":1746842491029,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"43bec56251114ebd8063fb3af69edf36","mode":"active"}]}
2025-05-10 11:01:31,713 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:01:31,714 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:01:31,714 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:01:31,714 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'HqzHrLIoIq5ey8rSFPQmVZ8ruuGij2C3rofSlk1qYXM=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:01:31,714 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377783021469958","quoteToken":"qb0M3m4lsbIKB0Je2jRRMILyxN6GcfzvmxhCSmcgFAYf0YcdgwkVDK8mWO_ZA6h0_-wKXzgnFU591_IRIzsfT2cKlGlqx2V2d9uBU1G-UhF8C_KmR1tUVl8812ae-7xI2JHVMZRjqyt-DtR9A4p1Zg","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYT6GQ03VFAS06GTK4SGJY","deliveryContext":{"isRedelivery":false},"timestamp":1746842491029,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"43bec56251114ebd8063fb3af69edf36","mode":"active"}]}
2025-05-10 11:01:31,714 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:01:31,714 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:01:31,714 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:01:31.714579+09:00
2025-05-10 11:01:31,714 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 11:01:31,714 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:01:31,715 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 11:01:31,715 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:01:31,716 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:01:31,716 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:01:31,716 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:01:31,716 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:01:31,717 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:01:31,717 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:01:31,719 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:01:31,719 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:01:31,720 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:01:31,720 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:01:33,277 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:01:33,278 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:01:33,278 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:01:33,278 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:01:33,282 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:01:33,658 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 11:01:33,658 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:01:33,815 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:01:33,815 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:01:33,816 - __main__ - INFO - Request processed in 2.11 seconds
2025-05-10 11:01:33,816 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:01:33,816 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:01:33,817 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:01:33] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:01:37,018 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:01:37,019 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'iyax+RlT8uE4FkrZBZz0F3Yar0PRJHS212+SaU7reyw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:01:37,019 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377792199131206","quoteToken":"jaH4s5HecGlu0KvQuApXpKlXc0MK7XfZH59ga5mwIOy9BvxJXZJkSLuRAiFXcLEdtUtyN3X56FOG04cPwD-d6_3BOCijc0O8g5G9ri1b00znhfG33rq-LcnNH81bz1P6FMd3fSItstRNP7JcmA7_tw","text":"はい"},"webhookEventId":"01JTVYTBWTBDW0V7DA8FEK6NNQ","deliveryContext":{"isRedelivery":false},"timestamp":1746842496556,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"149d049eafe943eda2cc1b6629ed39cc","mode":"active"}]}
2025-05-10 11:01:37,019 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:01:37,020 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:01:37,020 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:01:37,020 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'iyax+RlT8uE4FkrZBZz0F3Yar0PRJHS212+SaU7reyw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:01:37,020 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377792199131206","quoteToken":"jaH4s5HecGlu0KvQuApXpKlXc0MK7XfZH59ga5mwIOy9BvxJXZJkSLuRAiFXcLEdtUtyN3X56FOG04cPwD-d6_3BOCijc0O8g5G9ri1b00znhfG33rq-LcnNH81bz1P6FMd3fSItstRNP7JcmA7_tw","text":"はい"},"webhookEventId":"01JTVYTBWTBDW0V7DA8FEK6NNQ","deliveryContext":{"isRedelivery":false},"timestamp":1746842496556,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"149d049eafe943eda2cc1b6629ed39cc","mode":"active"}]}
2025-05-10 11:01:37,021 - __main__ - DEBUG - pending_event: {'user_id': 'U6a99e85de7d2922e21b6769f9c98fd5b', 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None}
2025-05-10 11:01:37,023 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:01:37,023 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:01:37,024 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:01:37,024 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:01:37,803 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:01:37,804 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:01:37,804 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:01:37,809 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 11:01:38,330 - calendar_operations - INFO - 予定を追加しました: gi5t8bisgkaocluhd6k8ruud50
2025-05-10 11:01:38,331 - __main__ - DEBUG - LINEへの返信を開始: 予定「ｺﾝﾃﾝﾂ課MTG」を追加しました。
2025-05-10 11:01:38,331 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「ｺﾝﾃﾝﾂ課MTG」を追加しました。', emojis=None, quote_token=None)]
2025-05-10 11:01:38,401 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:01:38,401 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:01:38,402 - __main__ - INFO - Request processed in 1.38 seconds
2025-05-10 11:01:38,403 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:01:38,403 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:01:38,403 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:01:38] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:02:22,788 - database - INFO - データベースを初期化しました。
2025-05-10 11:02:22,788 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:02:22,793 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:02:22,793 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:02:35,576 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:02:35,577 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'Uk9+jp96/SpPBrqusLWT450zoOKpyVQajPKm70BFsD4=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:02:35,578 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377890244919673","quoteToken":"AxsFKZmY-0bKUgBCW224ZuFmfVFJz-vX7GLG_8NDTPzAn9MF3At9xhzo_diKZQTzbZGLkjwui7KQZm6sHD4blKdl8a36QOUDKyjT6sO_7400OlJpQ12PnLJkixEykucr2PCg-LYSwRFnsTACnUaNjQ","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYW52NE8VB5D6K1YSHHEYP","deliveryContext":{"isRedelivery":false},"timestamp":1746842554969,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"a6e3fbf6e32a4b62aada88a4c61dd7dc","mode":"active"}]}
2025-05-10 11:02:35,582 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:02:35,583 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:02:35,583 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:02:35,583 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'Uk9+jp96/SpPBrqusLWT450zoOKpyVQajPKm70BFsD4=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:02:35,584 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377890244919673","quoteToken":"AxsFKZmY-0bKUgBCW224ZuFmfVFJz-vX7GLG_8NDTPzAn9MF3At9xhzo_diKZQTzbZGLkjwui7KQZm6sHD4blKdl8a36QOUDKyjT6sO_7400OlJpQ12PnLJkixEykucr2PCg-LYSwRFnsTACnUaNjQ","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYW52NE8VB5D6K1YSHHEYP","deliveryContext":{"isRedelivery":false},"timestamp":1746842554969,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"a6e3fbf6e32a4b62aada88a4c61dd7dc","mode":"active"}]}
2025-05-10 11:02:35,585 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:02:35,585 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:02:35,585 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:02:35.585396+09:00
2025-05-10 11:02:35,586 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 11:02:35,586 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:02:35,586 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 11:02:35,587 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:02:35,590 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:02:35,590 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:02:35,591 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:02:35,591 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:02:35,591 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:02:35,592 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:02:35,597 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:02:35,598 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:02:35,599 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:02:35,599 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:02:36,166 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:02:36,167 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:02:36,167 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:02:36,167 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:02:36,177 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:02:36,556 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)
- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)

それでも追加しますか？
2025-05-10 11:02:36,557 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:02:36,702 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:02:36,702 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:02:36,703 - __main__ - INFO - Request processed in 1.13 seconds
2025-05-10 11:02:36,703 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:02:36,703 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:02:36,704 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:02:36] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:02:40,574 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:02:40,574 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'REVk3U5NJ/3v6FfIMxnnIJNH7kOXV8NnF++np+3c2XM=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:02:40,575 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377898885448109","quoteToken":"LgFdgm6t961ujk-rW9CcihA4_uSyIxGO6ZY2t-uJSwUT-Io4AlRx5nH3sKa_98q3E73ijIGoCapq9NLFY3jQW7_bl6GLz8lxWYd47pnmnfCBTnk33np5flMXsL0cmWPt17ilekbDDZvoKMZ9Arxl0g","text":"はい"},"webhookEventId":"01JTVYW9XPPK3G2MBJNEAM86Y5","deliveryContext":{"isRedelivery":false},"timestamp":1746842560071,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"2b1f309400af49dcabeec3e7085507de","mode":"active"}]}
2025-05-10 11:02:40,575 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:02:40,576 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:02:40,576 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:02:40,576 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'REVk3U5NJ/3v6FfIMxnnIJNH7kOXV8NnF++np+3c2XM=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:02:40,576 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377898885448109","quoteToken":"LgFdgm6t961ujk-rW9CcihA4_uSyIxGO6ZY2t-uJSwUT-Io4AlRx5nH3sKa_98q3E73ijIGoCapq9NLFY3jQW7_bl6GLz8lxWYd47pnmnfCBTnk33np5flMXsL0cmWPt17ilekbDDZvoKMZ9Arxl0g","text":"はい"},"webhookEventId":"01JTVYW9XPPK3G2MBJNEAM86Y5","deliveryContext":{"isRedelivery":false},"timestamp":1746842560071,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"2b1f309400af49dcabeec3e7085507de","mode":"active"}]}
2025-05-10 11:02:40,577 - __main__ - DEBUG - pending_event: {'user_id': 'U6a99e85de7d2922e21b6769f9c98fd5b', 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None}
2025-05-10 11:02:40,582 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:02:40,583 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:02:40,584 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:02:40,584 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:02:41,164 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:02:41,165 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:02:41,165 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:02:41,174 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 11:02:41,779 - calendar_operations - INFO - 予定を追加しました: s9ps4qvq29qlq38fpd2l5mpjs0
2025-05-10 11:02:41,780 - __main__ - ERROR - 予定追加時の例外: 'CalendarManager' object has no attribute 'get_events_for_day'
2025-05-10 11:02:41,780 - __main__ - DEBUG - LINEへの返信を開始: 予定の追加に失敗しました: 'CalendarManager' object has no attribute 'get_events_for_day'
2025-05-10 11:02:41,780 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text="予定の追加に失敗しました: 'CalendarManager' object has no attribute 'get_events_for_day'", emojis=None, quote_token=None)]
2025-05-10 11:02:41,855 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:02:41,855 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:02:41,855 - __main__ - INFO - Request processed in 1.28 seconds
2025-05-10 11:02:41,856 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:02:41,856 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:02:41,856 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:02:41] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:03:11,494 - database - INFO - データベースを初期化しました。
2025-05-10 11:03:11,494 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:03:11,498 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:03:11,498 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:03:22,068 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:03:22,069 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'PtyODolTEkcdL7wq2WuRbLgdbDZRm7xKvusOZmhXXUg=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:03:22,070 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377968426222192","quoteToken":"H1_fRkoSxBVpxzo1GC3udYzgEH4qVU1kCHPeUQIzhrwZIF6erg1vFoW0KnAt-48lo7vBUk0EvmmD_FQ-3ZAwzVlByJ0Yiyfd-d-a_Q3tpPGWVrkODUCy324h7a-_wxCEJyvso0JVIcjHWISmSiMC1A","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYXJFJ1TWYMPSD98CNQN0B","deliveryContext":{"isRedelivery":false},"timestamp":1746842601596,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ac50bc6ccb584db3adadabdcc068baaf","mode":"active"}]}
2025-05-10 11:03:22,075 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:03:22,076 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:03:22,076 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:03:22,076 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'PtyODolTEkcdL7wq2WuRbLgdbDZRm7xKvusOZmhXXUg=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:03:22,076 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377968426222192","quoteToken":"H1_fRkoSxBVpxzo1GC3udYzgEH4qVU1kCHPeUQIzhrwZIF6erg1vFoW0KnAt-48lo7vBUk0EvmmD_FQ-3ZAwzVlByJ0Yiyfd-d-a_Q3tpPGWVrkODUCy324h7a-_wxCEJyvso0JVIcjHWISmSiMC1A","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYXJFJ1TWYMPSD98CNQN0B","deliveryContext":{"isRedelivery":false},"timestamp":1746842601596,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ac50bc6ccb584db3adadabdcc068baaf","mode":"active"}]}
2025-05-10 11:03:22,077 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:03:22,078 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:03:22,078 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:03:22.078138+09:00
2025-05-10 11:03:22,079 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 11:03:22,079 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:03:22,079 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 11:03:22,079 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:03:22,082 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:03:22,082 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:03:22,083 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:03:22,083 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:03:22,083 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:03:22,083 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:03:22,089 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:03:22,089 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:03:22,091 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:03:22,091 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:03:22,685 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:03:22,686 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:03:22,686 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:03:22,687 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:03:22,696 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:03:22,980 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)
- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)
- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)

それでも追加しますか？
2025-05-10 11:03:22,981 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:03:23,177 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:03:23,178 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:03:23,182 - __main__ - INFO - Request processed in 1.11 seconds
2025-05-10 11:03:23,183 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:03:23,183 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:03:23,185 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:03:23] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:03:27,698 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:03:27,698 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'lSecz4sZKnvm+dlzteiZbXCb45lkzme1CIte4rAq7CA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:03:27,698 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377978241155176","quoteToken":"OWPV05zBPr7f5ZHxp9Nnk70Cj3cFI9lsbcw_QSn-PIacv6XEWR0wDofIFqchx1qeHQeAOjCCP-T_v47rHhBAP6W8hMUd3ROHDjd4Ej8Zmh4fUKdEzJjm-UjKqvg0coN2O_tSrVYeWYEpJLuuNLfkSw","text":"はい"},"webhookEventId":"01JTVYXQYY48XYP3MJQJ4SHMGJ","deliveryContext":{"isRedelivery":false},"timestamp":1746842607394,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"78b02ecb59ff4532ae24770f697a7abe","mode":"active"}]}
2025-05-10 11:03:27,699 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:03:27,700 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:03:27,700 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:03:27,700 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'lSecz4sZKnvm+dlzteiZbXCb45lkzme1CIte4rAq7CA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:03:27,700 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560377978241155176","quoteToken":"OWPV05zBPr7f5ZHxp9Nnk70Cj3cFI9lsbcw_QSn-PIacv6XEWR0wDofIFqchx1qeHQeAOjCCP-T_v47rHhBAP6W8hMUd3ROHDjd4Ej8Zmh4fUKdEzJjm-UjKqvg0coN2O_tSrVYeWYEpJLuuNLfkSw","text":"はい"},"webhookEventId":"01JTVYXQYY48XYP3MJQJ4SHMGJ","deliveryContext":{"isRedelivery":false},"timestamp":1746842607394,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"78b02ecb59ff4532ae24770f697a7abe","mode":"active"}]}
2025-05-10 11:03:27,701 - __main__ - DEBUG - pending_event: {'user_id': 'U6a99e85de7d2922e21b6769f9c98fd5b', 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None}
2025-05-10 11:03:27,705 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:03:27,705 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:03:27,707 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:03:27,708 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:03:28,281 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:03:28,282 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:03:28,282 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:03:28,287 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 11:03:28,682 - calendar_operations - INFO - 予定を追加しました: 069pkg6227c1ellncascnn9log
2025-05-10 11:03:28,690 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T00%3A00%3A00%2B09%3A00&timeMax=2025-05-19T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:03:28,960 - __main__ - DEBUG - LINEへの返信を開始: 予定「ｺﾝﾃﾝﾂ課MTG」を追加しました。

【その日の予定一覧】
・販促デジタル部MTG (13:00～14:00)
・ｺﾝﾃﾝﾂ課MTG (13:30～14:00)
・ｺﾝﾃﾝﾂ課MTG (13:30～14:00)
・ｺﾝﾃﾝﾂ課MTG (13:30～14:00)
2025-05-10 11:03:28,961 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「ｺﾝﾃﾝﾂ課MTG」を追加しました。\n\n【その日の予定一覧】\n・販促デジタル部MTG (13:00～14:00)\n・ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n・ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n・ｺﾝﾃﾝﾂ課MTG (13:30～14:00)', emojis=None, quote_token=None)]
2025-05-10 11:03:29,037 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:03:29,038 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:03:29,038 - __main__ - INFO - Request processed in 1.34 seconds
2025-05-10 11:03:29,038 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:03:29,038 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:03:29,039 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:03:29] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:04:32,885 - database - INFO - データベースを初期化しました。
2025-05-10 11:04:32,885 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:04:32,950 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:04:32,950 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:04:40,276 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:04:40,277 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '+ZKDIDg/jikFXy7hQHtqvTzqkqLk2usv7sqbuLInLlk=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:04:40,277 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378099573719177","quoteToken":"iV7sPgXDgfa2J83m7gMzBG_GeL5vfnklsPB2-Mo8TGwz4NqL1Nse0GngT08fpqAT-1Gq0CVJ7nPZ2njUDs0qsMlRpqp8_kNZ-mZqQ-lygVDo1ML_athswOXzjE-UlQ6BZa5kQhwfwjic3FPDL5E1Yg","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYZYV82F86MP4Q89H0F7K9","deliveryContext":{"isRedelivery":false},"timestamp":1746842679661,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"6868dda2d79e4fe99077d3b1dbf27b2a","mode":"active"}]}
2025-05-10 11:04:40,281 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:04:40,282 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:04:40,282 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:04:40,282 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '603', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '+ZKDIDg/jikFXy7hQHtqvTzqkqLk2usv7sqbuLInLlk=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:04:40,282 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378099573719177","quoteToken":"iV7sPgXDgfa2J83m7gMzBG_GeL5vfnklsPB2-Mo8TGwz4NqL1Nse0GngT08fpqAT-1Gq0CVJ7nPZ2njUDs0qsMlRpqp8_kNZ-mZqQ-lygVDo1ML_athswOXzjE-UlQ6BZa5kQhwfwjic3FPDL5E1Yg","text":"5月19日13時半\nコンテンツ課MTG\n30分"},"webhookEventId":"01JTVYZYV82F86MP4Q89H0F7K9","deliveryContext":{"isRedelivery":false},"timestamp":1746842679661,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"6868dda2d79e4fe99077d3b1dbf27b2a","mode":"active"}]}
2025-05-10 11:04:40,284 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:04:40,284 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:04:40,284 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:04:40.284497+09:00
2025-05-10 11:04:40,285 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 11:04:40,285 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:04:40,285 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 11:04:40,285 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:04:40,288 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:04:40,288 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:04:40,289 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:04:40,289 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
こんてんつ課MTG
30分
2025-05-10 11:04:40,289 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:04:40,290 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:04:40,294 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:04:40,294 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:04:40,295 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:04:40,296 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:04:40,901 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:04:40,902 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:04:40,902 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:04:40,903 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:04:40,913 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:04:41,175 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)
- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)
- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)
- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)

それでも追加しますか？
2025-05-10 11:04:41,176 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n- ｺﾝﾃﾝﾂ課MTG (13:30～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:04:41,322 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:04:41,322 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:04:41,323 - __main__ - INFO - Request processed in 1.05 seconds
2025-05-10 11:04:41,324 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:04:41,324 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:04:41,324 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:04:41] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:04:43,982 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:04:43,982 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'mPRnxNLDX9kZwUxL8k57IsFulwLCuX/06YuQDUk0dMY=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:04:43,982 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378106485932296","quoteToken":"nuOketokGQ1gkTBjkvJ5hxJSgreSjNUD_6QdpUrS89TirrxirXZ8lud8lOF4-NESXIt2hUwzYQ0LjxAlh9KIjadFSds1nzd8jC7eq2I7B4byLjxbeUX7lFlZq3pcXGPKLlVaJ_qptcv6IMv6PKenZQ","text":"はい"},"webhookEventId":"01JTVZ02GHS82SSHREDHH49CM2","deliveryContext":{"isRedelivery":false},"timestamp":1746842683781,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"2316394339174c5b99e13aa038f3e7fe","mode":"active"}]}
2025-05-10 11:04:43,982 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:04:43,982 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:04:43,982 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:04:43,983 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'mPRnxNLDX9kZwUxL8k57IsFulwLCuX/06YuQDUk0dMY=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:04:43,983 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378106485932296","quoteToken":"nuOketokGQ1gkTBjkvJ5hxJSgreSjNUD_6QdpUrS89TirrxirXZ8lud8lOF4-NESXIt2hUwzYQ0LjxAlh9KIjadFSds1nzd8jC7eq2I7B4byLjxbeUX7lFlZq3pcXGPKLlVaJ_qptcv6IMv6PKenZQ","text":"はい"},"webhookEventId":"01JTVZ02GHS82SSHREDHH49CM2","deliveryContext":{"isRedelivery":false},"timestamp":1746842683781,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"2316394339174c5b99e13aa038f3e7fe","mode":"active"}]}
2025-05-10 11:04:43,983 - __main__ - DEBUG - pending_event: {'user_id': 'U6a99e85de7d2922e21b6769f9c98fd5b', 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'title': 'ｺﾝﾃﾝﾂ課MTG', 'location': None, 'person': None, 'recurrence': None}
2025-05-10 11:04:43,985 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:04:43,985 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:04:43,986 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:04:43,986 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:04:44,560 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:04:44,561 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:04:44,561 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:04:44,570 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 11:04:45,101 - calendar_operations - INFO - 予定を追加しました: p5s54vnnos94qj0mjehe0qqvgg
2025-05-10 11:04:45,109 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T00%3A00%3A00%2B09%3A00&timeMax=2025-05-19T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:04:45,371 - __main__ - DEBUG - LINEへの返信を開始: 予定「ｺﾝﾃﾝﾂ課MTG」を追加しました。

📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

2. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

3. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

4. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

5. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

━━━━━━━━━━
2025-05-10 11:04:45,371 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「ｺﾝﾃﾝﾂ課MTG」を追加しました。\n\n📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n2. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n3. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n4. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n5. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:04:45,448 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:04:45,449 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:04:45,449 - __main__ - INFO - Request processed in 1.47 seconds
2025-05-10 11:04:45,450 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:04:45,450 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:04:45,450 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:04:45] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:05:05,018 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:05:05,018 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'dYimbBKapdxHdKnWzcREbF6d83bKkPES2PXwfR7Ahqo=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:05:05,019 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378140929557287","quoteToken":"RqpwPS1hGzPyF61KZZwPMabC-qcVr9Eaa7xynbm52KVGbrydPNz95FPNPRcjH-fx5sn6StGosP_qMKu6YCVWW39f2rmFEmOorzEYBr0UIQZ4a8RKa-yL381qFyU6tPYp6ZvTIVpYHCxhrf59EVXAkQ","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ0Q0Y8AVABEXQDCK8BT2B","deliveryContext":{"isRedelivery":false},"timestamp":1746842704419,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"3adfd97f2cdd418299b7477f3bb28220","mode":"active"}]}
2025-05-10 11:05:05,019 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:05:05,020 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:05:05,021 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:05:05,021 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'dYimbBKapdxHdKnWzcREbF6d83bKkPES2PXwfR7Ahqo=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:05:05,021 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378140929557287","quoteToken":"RqpwPS1hGzPyF61KZZwPMabC-qcVr9Eaa7xynbm52KVGbrydPNz95FPNPRcjH-fx5sn6StGosP_qMKu6YCVWW39f2rmFEmOorzEYBr0UIQZ4a8RKa-yL381qFyU6tPYp6ZvTIVpYHCxhrf59EVXAkQ","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ0Q0Y8AVABEXQDCK8BT2B","deliveryContext":{"isRedelivery":false},"timestamp":1746842704419,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"3adfd97f2cdd418299b7477f3bb28220","mode":"active"}]}
2025-05-10 11:05:05,022 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:05:05,022 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:05:05,023 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:05:05.022816+09:00
2025-05-10 11:05:05,023 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:05:05,023 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:05:05,023 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:30:00+09:00
2025-05-10 11:05:05,023 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:05:05,024 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:05:05,024 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:05:05,024 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:05:05,024 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:05:05,024 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:05:05,024 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:05:05,030 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:05:05,030 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:05:05,031 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:05:05,032 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:05:05,652 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:05:05,653 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:05:05,653 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:05:05,653 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:05:05,655 - __main__ - DEBUG - LINEへの返信を開始: 削除する予定の番号を指定してください。
2025-05-10 11:05:05,655 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='削除する予定の番号を指定してください。', emojis=None, quote_token=None)]
2025-05-10 11:05:05,755 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:05:05,755 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:05:05,756 - __main__ - INFO - Request processed in 0.74 seconds
2025-05-10 11:05:05,756 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:05:05,756 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:05:05,757 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:05:05] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:06:45,809 - database - INFO - データベースを初期化しました。
2025-05-10 11:06:45,809 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:06:46,011 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:06:46,012 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:06:59,324 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:06:59,324 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'BFt1FsjqhOvvNQ1imu2h8+VWHecyl+U1k5yQrBU/WGY=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:06:59,325 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378333431332916","quoteToken":"3Z27iRigHRKrVuCoLc-usudeea2Y3j6y-56lqnU6lCOQ-lLFyxZ3C4wog6ZJRGO0zjhoWVgI_rAmp1krcVK1utQw5N7zIzSC2G2A6OiGIak-NCnYZOe6ed5SflfCufMwK2YV9yst2ZNkPIUgZhqQ7w","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ46MS52R9NQCY2D0HJPJJ","deliveryContext":{"isRedelivery":false},"timestamp":1746842819049,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"2f35fe0970d84ebfb17c0cb5b9fb5185","mode":"active"}]}
2025-05-10 11:06:59,330 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:06:59,331 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:06:59,331 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:06:59,332 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'BFt1FsjqhOvvNQ1imu2h8+VWHecyl+U1k5yQrBU/WGY=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:06:59,332 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378333431332916","quoteToken":"3Z27iRigHRKrVuCoLc-usudeea2Y3j6y-56lqnU6lCOQ-lLFyxZ3C4wog6ZJRGO0zjhoWVgI_rAmp1krcVK1utQw5N7zIzSC2G2A6OiGIak-NCnYZOe6ed5SflfCufMwK2YV9yst2ZNkPIUgZhqQ7w","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ46MS52R9NQCY2D0HJPJJ","deliveryContext":{"isRedelivery":false},"timestamp":1746842819049,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"2f35fe0970d84ebfb17c0cb5b9fb5185","mode":"active"}]}
2025-05-10 11:06:59,333 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:06:59,334 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:06:59,334 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:06:59.333936+09:00
2025-05-10 11:06:59,334 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:06:59,334 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:06:59,335 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:30:00+09:00
2025-05-10 11:06:59,335 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:06:59,338 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:06:59,338 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:06:59,339 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:06:59,339 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:06:59,339 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:06:59,339 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:06:59,343 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:06:59,343 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:06:59,345 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:06:59,345 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:06:59,928 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:06:59,929 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:06:59,929 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:06:59,929 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:06:59,940 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A30%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:07:00,236 - __main__ - DEBUG - LINEへの返信を開始: 該当する予定が複数あります。削除したい予定の番号を指定してください。

📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

2. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

3. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

4. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

5. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

━━━━━━━━━━
2025-05-10 11:07:00,237 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='該当する予定が複数あります。削除したい予定の番号を指定してください。\n\n📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n2. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n3. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n4. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n5. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:07:00,373 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:07:00,374 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:07:00,394 - __main__ - INFO - Request processed in 1.07 seconds
2025-05-10 11:07:00,394 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:07:00,394 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:07:00,395 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:07:00] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:07:51,678 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:07:51,679 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '563', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '1BTwFvC9YW7d5wSRjqRhDG4Im8h8vMvr7KIuY8Q1zUI=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:07:51,679 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378421209727218","quoteToken":"1l6f_gz7YSmbgyaFK8PuuGWVMo-sVjPtd3yA8fGOuCP-crMbMW1m65Pr42SP-JpRQDPJHGGtnxTj3tApqCL8BU73PeP9_8TNOLbG9Z2jEAZEmZwGM71bcLpWqAgqe8zqXUQCx9GwHNB5IXYuvCFhbA","text":"2.3.4.5"},"webhookEventId":"01JTVZ5SSDRQ082Q56STWXSX1V","deliveryContext":{"isRedelivery":false},"timestamp":1746842871536,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1df677d5cfed4024b342ad409fb3361a","mode":"active"}]}
2025-05-10 11:07:51,680 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:07:51,680 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:07:51,681 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:07:51,681 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '563', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '1BTwFvC9YW7d5wSRjqRhDG4Im8h8vMvr7KIuY8Q1zUI=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:07:51,681 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378421209727218","quoteToken":"1l6f_gz7YSmbgyaFK8PuuGWVMo-sVjPtd3yA8fGOuCP-crMbMW1m65Pr42SP-JpRQDPJHGGtnxTj3tApqCL8BU73PeP9_8TNOLbG9Z2jEAZEmZwGM71bcLpWqAgqe8zqXUQCx9GwHNB5IXYuvCFhbA","text":"2.3.4.5"},"webhookEventId":"01JTVZ5SSDRQ082Q56STWXSX1V","deliveryContext":{"isRedelivery":false},"timestamp":1746842871536,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1df677d5cfed4024b342ad409fb3361a","mode":"active"}]}
2025-05-10 11:07:51,682 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:07:51,682 - message_parser - DEBUG - 正規化後のメッセージ: 2.3.4.5
2025-05-10 11:07:51,682 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:07:51.682413+09:00
2025-05-10 11:07:51,683 - message_parser - DEBUG - メッセージ解析結果: None
2025-05-10 11:07:51,683 - message_parser - DEBUG - 時間抽出開始: 2.3.4.5
2025-05-10 11:07:51,685 - message_parser - DEBUG - 日付のみの時間情報: 2025-05-10 00:00:00+09:00 から 2025-05-10 23:59:00+09:00
2025-05-10 11:07:51,685 - message_parser - DEBUG - 時間抽出開始: 2.3.4.5
2025-05-10 11:07:51,686 - message_parser - DEBUG - タイトル抽出開始: 2.3.4.5
2025-05-10 11:07:51,686 - message_parser - DEBUG - 繰り返し情報を抽出: 2.3.4.5
2025-05-10 11:07:51,686 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:07:51,687 - message_parser - DEBUG - 繰り返し情報を抽出: 2.3.4.5
2025-05-10 11:07:51,687 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:07:51,687 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': '2.3.4.5', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 10, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 10, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:07:51,691 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:07:51,691 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:07:51,693 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:07:51,693 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:07:52,364 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:07:52,365 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:07:52,365 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:07:52,365 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:07:52,374 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-10T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:07:52,672 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- はい (00:00～23:59)

それでも追加しますか？
2025-05-10 11:07:52,673 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- はい (00:00～23:59)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:07:52,730 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:07:52,730 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:07:52,731 - __main__ - INFO - Request processed in 1.05 seconds
2025-05-10 11:07:52,732 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:07:52,732 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:07:52,732 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:07:52] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:08:49,755 - database - INFO - データベースを初期化しました。
2025-05-10 11:08:49,755 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:08:49,897 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:08:49,897 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:09:01,411 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:09:01,411 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '3RzzWj0pCcYh2y4UEOFtoMAmDASp9S5YlWB3lk2xU6g=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:09:01,412 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378537576759629","quoteToken":"uRuHJnvMEN14_NP22_VxFopoPKHIfI4shmeYbW4W7HLhF-L8sTXdWOtknFJu-egldwcLOgpDCp6jD9Q61hbar5K7C8gLhgufpTY3aOQPlW0Et1GUfdMPEzMY5v9NGqZRrCB90ZueVyOOVDrR_iiJxw","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ7XRZYXH2CER1K3QGZAJH","deliveryContext":{"isRedelivery":false},"timestamp":1746842940919,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"bf2dd67b69d74143a75e7f5299bd0909","mode":"active"}]}
2025-05-10 11:09:01,416 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:09:01,417 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:09:01,417 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:09:01,417 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '3RzzWj0pCcYh2y4UEOFtoMAmDASp9S5YlWB3lk2xU6g=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:09:01,417 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378537576759629","quoteToken":"uRuHJnvMEN14_NP22_VxFopoPKHIfI4shmeYbW4W7HLhF-L8sTXdWOtknFJu-egldwcLOgpDCp6jD9Q61hbar5K7C8gLhgufpTY3aOQPlW0Et1GUfdMPEzMY5v9NGqZRrCB90ZueVyOOVDrR_iiJxw","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ7XRZYXH2CER1K3QGZAJH","deliveryContext":{"isRedelivery":false},"timestamp":1746842940919,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"bf2dd67b69d74143a75e7f5299bd0909","mode":"active"}]}
2025-05-10 11:09:01,418 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:09:01,419 - __main__ - DEBUG - メッセージの解析結果: None
2025-05-10 11:09:01,419 - __main__ - WARNING - メッセージの解析に失敗
2025-05-10 11:09:01,419 - __main__ - DEBUG - LINEへの返信を開始: すみません、メッセージを理解できませんでした。
2025-05-10 11:09:01,420 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='すみません、メッセージを理解できませんでした。', emojis=None, quote_token=None)]
2025-05-10 11:09:01,529 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:09:01,529 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:09:01,530 - __main__ - INFO - Request processed in 0.12 seconds
2025-05-10 11:09:01,530 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:09:01,530 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:09:01,530 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:09:01] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:09:50,370 - database - INFO - データベースを初期化しました。
2025-05-10 11:09:50,371 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:09:50,375 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:09:50,375 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:10:01,343 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:10:01,344 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'Grw+pmTufM2VtYD+mXRpuTni9Zh/WMyS3hM12uOZv9M=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:10:01,345 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378638039253341","quoteToken":"DbW8TfSgaOCycO9Vu597pRJsLi712ixS31hPfM18bG479xqSxww72T4aSM2Qp3gbHaxVmDBy2UnlzdEGpQ2aOJ_icdLlkgWtoCvSZsevTMZJddfL-RFtpJO11mAtV-5V_5EhPtmnEb2U0KhvmjKTgA","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ9RBSXC3MFHNBT7DJBTS7","deliveryContext":{"isRedelivery":false},"timestamp":1746843000759,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"c79ea995d3934d52abad8eec08932ef4","mode":"active"}]}
2025-05-10 11:10:01,349 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:10:01,350 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:10:01,350 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:10:01,350 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'Grw+pmTufM2VtYD+mXRpuTni9Zh/WMyS3hM12uOZv9M=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:10:01,351 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378638039253341","quoteToken":"DbW8TfSgaOCycO9Vu597pRJsLi712ixS31hPfM18bG479xqSxww72T4aSM2Qp3gbHaxVmDBy2UnlzdEGpQ2aOJ_icdLlkgWtoCvSZsevTMZJddfL-RFtpJO11mAtV-5V_5EhPtmnEb2U0KhvmjKTgA","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZ9RBSXC3MFHNBT7DJBTS7","deliveryContext":{"isRedelivery":false},"timestamp":1746843000759,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"c79ea995d3934d52abad8eec08932ef4","mode":"active"}]}
2025-05-10 11:10:01,352 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:10:01,352 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:10:01,353 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:10:01.352908+09:00
2025-05-10 11:10:01,353 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:10:01,353 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:10:01,354 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:30:00+09:00
2025-05-10 11:10:01,354 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:10:01,356 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:10:01,356 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:10:01,358 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:10:01,358 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:10:01,358 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:10:01,358 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:10:01,363 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:10:01,363 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:10:01,364 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:10:01,365 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:10:02,001 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:10:02,002 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:10:02,002 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:10:02,002 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:10:02,014 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A30%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:10:02,413 - __main__ - DEBUG - LINEへの返信を開始: 該当する予定が複数あります。削除したい予定の番号を指定してください。

📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

2. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

3. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

4. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

5. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

━━━━━━━━━━
2025-05-10 11:10:02,413 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='該当する予定が複数あります。削除したい予定の番号を指定してください。\n\n📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n2. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n3. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n4. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n5. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:10:02,515 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:10:02,516 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:10:02,516 - __main__ - INFO - Request processed in 1.17 seconds
2025-05-10 11:10:02,516 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:10:02,516 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:10:02,517 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:10:02] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:10:10,242 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:10:10,243 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '563', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'rucdFJkqWfYh71yVmH15h2SltTJUCcnxpwLQ1YhyF/g=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:10:10,243 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378653793059210","quoteToken":"qmxDDyJfHOLWqGyejCdas7rzOBRk_tT70MMndFsNL6uslQafGkhSUoYWY4oB9qLIwwhFb2O9AL6eL7azgshkLtVflgu9_AYuXloCnF28fz2AieC-87iwr4jGU10l8s_GBr4MDQCmca2n81S54zlVOg","text":"2.3.4.5"},"webhookEventId":"01JTVZA1505MSK9S1CN9WKZH5Z","deliveryContext":{"isRedelivery":false},"timestamp":1746843010032,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1519a9b6f11d464da951777f854a3c76","mode":"active"}]}
2025-05-10 11:10:10,244 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:10:10,244 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:10:10,245 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:10:10,245 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '563', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'rucdFJkqWfYh71yVmH15h2SltTJUCcnxpwLQ1YhyF/g=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:10:10,245 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378653793059210","quoteToken":"qmxDDyJfHOLWqGyejCdas7rzOBRk_tT70MMndFsNL6uslQafGkhSUoYWY4oB9qLIwwhFb2O9AL6eL7azgshkLtVflgu9_AYuXloCnF28fz2AieC-87iwr4jGU10l8s_GBr4MDQCmca2n81S54zlVOg","text":"2.3.4.5"},"webhookEventId":"01JTVZA1505MSK9S1CN9WKZH5Z","deliveryContext":{"isRedelivery":false},"timestamp":1746843010032,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1519a9b6f11d464da951777f854a3c76","mode":"active"}]}
2025-05-10 11:10:10,246 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:10:10,247 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'delete_indexes': [2, 3, 4, 5]}
2025-05-10 11:10:10,251 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:10:10,251 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:10:10,252 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:10:10,253 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:10:10,834 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:10:10,835 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:10:10,835 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:10:10,836 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:10:10,836 - calendar_operations - ERROR - 予定の取得に失敗: 'NoneType' object has no attribute 'tzinfo'
2025-05-10 11:10:10,847 - calendar_operations - ERROR - Traceback (most recent call last):
  File "/Users/kikuchimizuki/Desktop/LINEでカレンダー/calendar_operations.py", line 333, in get_events
    if start_time.tzinfo is None:
AttributeError: 'NoneType' object has no attribute 'tzinfo'

2025-05-10 11:10:10,848 - __main__ - DEBUG - LINEへの返信を開始: 指定された日付・時間帯に予定はありません。
2025-05-10 11:10:10,848 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='指定された日付・時間帯に予定はありません。', emojis=None, quote_token=None)]
2025-05-10 11:10:10,935 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:10:10,936 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:10:10,936 - __main__ - INFO - Request processed in 0.69 seconds
2025-05-10 11:10:10,936 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:10:10,936 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:10:10,937 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:10:10] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:11:11,037 - database - INFO - データベースを初期化しました。
2025-05-10 11:11:11,037 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:11:11,181 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:11:11,181 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:11:20,247 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:11:20,248 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '1MlnrFDBuFzi3bDasxLOq1k/QZoc/SIi8gKQlQRXCkI=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:11:20,248 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378771434111185","quoteToken":"4HLQN-mTT6swMXNfgGXN1HxOjQF3UjB7bo7Sh32VR9kyxLxM_mraaiEeWpOAHazmCWMLNnsRZhrMLvxjmVx5x8oN731565F2pE-eRYtv7y3gQG4HLLItu5EhJQySfyo5oOyLwhIRbQyvKXhlbhqCkg","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZC5E76PHGKNWXZ8KYQWG3","deliveryContext":{"isRedelivery":false},"timestamp":1746843080123,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ae9b0536418b45688908b72bcd68bfb4","mode":"active"}]}
2025-05-10 11:11:20,253 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:11:20,254 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:11:20,254 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:11:20,254 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '1MlnrFDBuFzi3bDasxLOq1k/QZoc/SIi8gKQlQRXCkI=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:11:20,254 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378771434111185","quoteToken":"4HLQN-mTT6swMXNfgGXN1HxOjQF3UjB7bo7Sh32VR9kyxLxM_mraaiEeWpOAHazmCWMLNnsRZhrMLvxjmVx5x8oN731565F2pE-eRYtv7y3gQG4HLLItu5EhJQySfyo5oOyLwhIRbQyvKXhlbhqCkg","text":"5月19日13時半からの予定をキャンセル"},"webhookEventId":"01JTVZC5E76PHGKNWXZ8KYQWG3","deliveryContext":{"isRedelivery":false},"timestamp":1746843080123,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ae9b0536418b45688908b72bcd68bfb4","mode":"active"}]}
2025-05-10 11:11:20,255 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:11:20,256 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:11:20,256 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:11:20.256472+09:00
2025-05-10 11:11:20,257 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:11:20,257 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:11:20,257 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:30:00+09:00
2025-05-10 11:11:20,257 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:11:20,260 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:11:20,260 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:11:20,261 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:11:20,261 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半からの予定をきゃんせる
2025-05-10 11:11:20,261 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:11:20,261 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:11:20,267 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:11:20,267 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:11:20,269 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:11:20,269 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:11:20,856 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:11:20,857 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:11:20,857 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:11:20,857 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:11:20,867 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A30%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:11:21,163 - __main__ - DEBUG - LINEへの返信を開始: 該当する予定が複数あります。削除したい予定の番号を指定してください。

📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

2. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

3. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

4. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

5. ｺﾝﾃﾝﾂ課MTG
   🕘 13:30～14:00

━━━━━━━━━━
2025-05-10 11:11:21,163 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='該当する予定が複数あります。削除したい予定の番号を指定してください。\n\n📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n2. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n3. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n4. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n5. ｺﾝﾃﾝﾂ課MTG\n   🕘 13:30～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:11:21,288 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:11:21,289 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:11:21,289 - __main__ - INFO - Request processed in 1.04 seconds
2025-05-10 11:11:21,290 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:11:21,290 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:11:21,290 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:11:21] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:11:29,867 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:11:29,867 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '563', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'LFb2bBbKgCjnZALDLd9C24619ShnCjF4cKBEKoaj9oc=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:11:29,868 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378787070476289","quoteToken":"CmgsIctzsQxO8Zk47mcWePnqSSbMZ0qmxlfd6G3gSLAtb66uGjJ6q0zs1fG-qz1FFkulJYNIl7_V5fM1vsQNot8HKF9PrnIJ1KNNrCC9oK2qNYAl_oq45U82fIpXmPjf7Dr2a1O9wwsUcglzShqfrw","text":"2.3.4.5"},"webhookEventId":"01JTVZCEVTB7TTFC948M0MG0RB","deliveryContext":{"isRedelivery":false},"timestamp":1746843089438,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"97244116b0974379a029b5c9b7db08a0","mode":"active"}]}
2025-05-10 11:11:29,868 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:11:29,869 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:11:29,869 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:11:29,869 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '563', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'LFb2bBbKgCjnZALDLd9C24619ShnCjF4cKBEKoaj9oc=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:11:29,869 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378787070476289","quoteToken":"CmgsIctzsQxO8Zk47mcWePnqSSbMZ0qmxlfd6G3gSLAtb66uGjJ6q0zs1fG-qz1FFkulJYNIl7_V5fM1vsQNot8HKF9PrnIJ1KNNrCC9oK2qNYAl_oq45U82fIpXmPjf7Dr2a1O9wwsUcglzShqfrw","text":"2.3.4.5"},"webhookEventId":"01JTVZCEVTB7TTFC948M0MG0RB","deliveryContext":{"isRedelivery":false},"timestamp":1746843089438,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"97244116b0974379a029b5c9b7db08a0","mode":"active"}]}
2025-05-10 11:11:29,870 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:11:29,871 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'delete_indexes': [2, 3, 4, 5]}
2025-05-10 11:11:29,876 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:11:29,876 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:11:29,877 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:11:29,878 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:11:30,467 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:11:30,468 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:11:30,468 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:11:30,468 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:11:30,477 - googleapiclient.discovery - DEBUG - URL being requested: DELETE https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events/069pkg6227c1ellncascnn9log?
2025-05-10 11:11:30,980 - calendar_operations - INFO - 予定を削除しました: 069pkg6227c1ellncascnn9log
2025-05-10 11:11:30,987 - googleapiclient.discovery - DEBUG - URL being requested: DELETE https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events/gi5t8bisgkaocluhd6k8ruud50?
2025-05-10 11:11:31,410 - calendar_operations - INFO - 予定を削除しました: gi5t8bisgkaocluhd6k8ruud50
2025-05-10 11:11:31,417 - googleapiclient.discovery - DEBUG - URL being requested: DELETE https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events/p5s54vnnos94qj0mjehe0qqvgg?
2025-05-10 11:11:31,840 - calendar_operations - INFO - 予定を削除しました: p5s54vnnos94qj0mjehe0qqvgg
2025-05-10 11:11:31,847 - googleapiclient.discovery - DEBUG - URL being requested: DELETE https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events/s9ps4qvq29qlq38fpd2l5mpjs0?
2025-05-10 11:11:32,360 - calendar_operations - INFO - 予定を削除しました: s9ps4qvq29qlq38fpd2l5mpjs0
2025-05-10 11:11:32,361 - __main__ - DEBUG - LINEへの返信を開始: ｺﾝﾃﾝﾂ課MTG, ｺﾝﾃﾝﾂ課MTG, ｺﾝﾃﾝﾂ課MTG, ｺﾝﾃﾝﾂ課MTG を削除しました。
2025-05-10 11:11:32,361 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='ｺﾝﾃﾝﾂ課MTG, ｺﾝﾃﾝﾂ課MTG, ｺﾝﾃﾝﾂ課MTG, ｺﾝﾃﾝﾂ課MTG を削除しました。', emojis=None, quote_token=None)]
2025-05-10 11:11:32,435 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:11:32,435 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:11:32,438 - __main__ - INFO - Request processed in 2.57 seconds
2025-05-10 11:11:32,439 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:11:32,439 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:11:32,442 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:11:32] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:12:25,586 - database - INFO - データベースを初期化しました。
2025-05-10 11:12:25,586 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:12:25,590 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:12:25,590 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:12:40,877 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:12:40,877 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '586', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'mJaDoo/VHINsLsFq3Bqv+N7Dewr+R1WUrSjjxdleilQ=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:12:40,878 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378906608664869","quoteToken":"Hn3Df1TOtOWF5-FUKVWWYF20kPDCgsavKXLxXy4sBwBfJqqPXO1yv7HQLbeubSj-kHSHj1yB5KS4vOkwlcJmKqsDGt814Vi3liVkoMehsh3hqM74-ilX2GWsodBKhuz4crC0A2cxYa7U5hIoi8km2g","text":"5月19日の予定を教えて"},"webhookEventId":"01JTVZEM6G5JXWX1YFWT32A7V8","deliveryContext":{"isRedelivery":false},"timestamp":1746843160754,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1e1a69f0b7894c748fcdcab09943fdf9","mode":"active"}]}
2025-05-10 11:12:40,883 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:12:40,884 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:12:40,884 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:12:40,885 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '586', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'mJaDoo/VHINsLsFq3Bqv+N7Dewr+R1WUrSjjxdleilQ=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:12:40,885 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378906608664869","quoteToken":"Hn3Df1TOtOWF5-FUKVWWYF20kPDCgsavKXLxXy4sBwBfJqqPXO1yv7HQLbeubSj-kHSHj1yB5KS4vOkwlcJmKqsDGt814Vi3liVkoMehsh3hqM74-ilX2GWsodBKhuz4crC0A2cxYa7U5hIoi8km2g","text":"5月19日の予定を教えて"},"webhookEventId":"01JTVZEM6G5JXWX1YFWT32A7V8","deliveryContext":{"isRedelivery":false},"timestamp":1746843160754,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1e1a69f0b7894c748fcdcab09943fdf9","mode":"active"}]}
2025-05-10 11:12:40,886 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:12:40,887 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日の予定を教えて
2025-05-10 11:12:40,887 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:12:40.887004+09:00
2025-05-10 11:12:40,887 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:12:40,887 - message_parser - DEBUG - 時間抽出開始: 5月19日の予定を教えて
2025-05-10 11:12:40,889 - message_parser - DEBUG - X月Y日パターン: 2025-05-19 00:00:00+09:00 から 2025-05-19 23:59:00+09:00
2025-05-10 11:12:40,889 - message_parser - DEBUG - 時間抽出開始: 5月19日の予定を教えて
2025-05-10 11:12:40,891 - message_parser - DEBUG - タイトル抽出開始: 5月19日の予定を教えて
2025-05-10 11:12:40,891 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日の予定を教えて
2025-05-10 11:12:40,892 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:12:40,892 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日の予定を教えて
2025-05-10 11:12:40,892 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:12:40,892 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:12:40,897 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:12:40,898 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:12:40,899 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:12:40,899 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:12:41,486 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:12:41,487 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:12:41,487 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:12:41,487 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:12:41,496 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T00%3A00%3A00%2B09%3A00&timeMax=2025-05-19T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:12:41,851 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

━━━━━━━━━━
2025-05-10 11:12:41,852 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:12:42,012 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:12:42,012 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:12:42,012 - __main__ - INFO - Request processed in 1.14 seconds
2025-05-10 11:12:42,012 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:12:42,013 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:12:42,013 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:12:42] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:13:18,378 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:18,378 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'HQ3KkN7g8xZSX/eDFNHRWfteTYvETvmv6c8sGxd1tfw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:18,379 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378968500076980","quoteToken":"5KFOZ1CHTiirw4HSB1xMIEtwyerQ_A11jTh1ITN8c7qhMkkQ9RX-peKU2o2HuhuM9pyR-GxbZ7FuNPCy6B_9SFUFUVlfk7yuMfG8AktTUT_61Lhnm1541i1rLpfJ3FvFUVtCrBymVaPq5N3qT3S24Q","text":"5月19日13時半\n販促デジタル部MTG\n30分"},"webhookEventId":"01JTVZFRTN4XEDG2X0964XVVTP","deliveryContext":{"isRedelivery":false},"timestamp":1746843197782,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ebbd4c2941ba453ca312812db4ed1a5e","mode":"active"}]}
2025-05-10 11:13:18,379 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:13:18,379 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:13:18,379 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:18,380 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'HQ3KkN7g8xZSX/eDFNHRWfteTYvETvmv6c8sGxd1tfw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:18,380 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378968500076980","quoteToken":"5KFOZ1CHTiirw4HSB1xMIEtwyerQ_A11jTh1ITN8c7qhMkkQ9RX-peKU2o2HuhuM9pyR-GxbZ7FuNPCy6B_9SFUFUVlfk7yuMfG8AktTUT_61Lhnm1541i1rLpfJ3FvFUVtCrBymVaPq5N3qT3S24Q","text":"5月19日13時半\n販促デジタル部MTG\n30分"},"webhookEventId":"01JTVZFRTN4XEDG2X0964XVVTP","deliveryContext":{"isRedelivery":false},"timestamp":1746843197782,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ebbd4c2941ba453ca312812db4ed1a5e","mode":"active"}]}
2025-05-10 11:13:18,381 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:13:18,381 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:18,381 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:13:18.381308+09:00
2025-05-10 11:13:18,381 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 11:13:18,381 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:18,382 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 11:13:18,382 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:18,382 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:18,382 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:18,382 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:13:18,382 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:18,382 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:13:18,382 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': '販促ﾃﾞｼﾞﾀﾙ部MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:13:18,384 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:13:18,384 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:13:18,385 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:13:18,385 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:13:19,021 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:13:19,022 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:13:19,022 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:13:19,022 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:13:19,030 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:13:19,324 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)

それでも追加しますか？
2025-05-10 11:13:19,325 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:13:19,401 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:13:19,401 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:13:19,403 - __main__ - INFO - Request processed in 1.02 seconds
2025-05-10 11:13:19,403 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:13:19,403 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:13:19,403 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:13:19] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:13:22,593 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:22,593 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '6MedY+xb1JZqRVFohW9WIEv7CZn6V/E1aRBMSzlTF8Y=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:22,594 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378975596315111","quoteToken":"R-zBVORV0tKSrD4ttfWOGT0MWukFbOYIHW_aIT58-Hjdv4A9QjnSSBWCXUnXmbvxzandDoE6NFLgD9I1oQg-VT9Zk9fgEQhBIr42OgFx8Naop8OfiRYOD6X0muHXMLXDI7UtARv9toGgk-GpEdu-og","text":"はい"},"webhookEventId":"01JTVZFWXV18VD9CTE70DQA2PX","deliveryContext":{"isRedelivery":false},"timestamp":1746843201985,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"70cec8f99cf64e71b046125fe1f72e94","mode":"active"}]}
2025-05-10 11:13:22,594 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:13:22,594 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:13:22,594 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:22,594 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '562', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '6MedY+xb1JZqRVFohW9WIEv7CZn6V/E1aRBMSzlTF8Y=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:22,594 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378975596315111","quoteToken":"R-zBVORV0tKSrD4ttfWOGT0MWukFbOYIHW_aIT58-Hjdv4A9QjnSSBWCXUnXmbvxzandDoE6NFLgD9I1oQg-VT9Zk9fgEQhBIr42OgFx8Naop8OfiRYOD6X0muHXMLXDI7UtARv9toGgk-GpEdu-og","text":"はい"},"webhookEventId":"01JTVZFWXV18VD9CTE70DQA2PX","deliveryContext":{"isRedelivery":false},"timestamp":1746843201985,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"70cec8f99cf64e71b046125fe1f72e94","mode":"active"}]}
2025-05-10 11:13:22,595 - __main__ - DEBUG - pending_event: {'user_id': 'U6a99e85de7d2922e21b6769f9c98fd5b', 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'title': '販促ﾃﾞｼﾞﾀﾙ部MTG', 'location': None, 'person': None, 'recurrence': None}
2025-05-10 11:13:22,596 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:13:22,596 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:13:22,597 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:13:22,597 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:13:23,177 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:13:23,178 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:13:23,178 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:13:23,187 - googleapiclient.discovery - DEBUG - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?alt=json
2025-05-10 11:13:23,731 - calendar_operations - INFO - 予定を追加しました: 7qdaami6muffp9t55ue6ssgbro
2025-05-10 11:13:23,737 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T00%3A00%3A00%2B09%3A00&timeMax=2025-05-19T23%3A59%3A59.999999%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:13:24,034 - __main__ - DEBUG - LINEへの返信を開始: 予定「販促ﾃﾞｼﾞﾀﾙ部MTG」を追加しました。

📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

2. 販促ﾃﾞｼﾞﾀﾙ部MTG
   🕘 13:30～14:00

━━━━━━━━━━
2025-05-10 11:13:24,035 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「販促ﾃﾞｼﾞﾀﾙ部MTG」を追加しました。\n\n📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n2. 販促ﾃﾞｼﾞﾀﾙ部MTG\n   🕘 13:30～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:13:24,087 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:13:24,087 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:13:24,093 - __main__ - INFO - Request processed in 1.50 seconds
2025-05-10 11:13:24,096 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:13:24,099 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:13:24,100 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:13:24] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:13:34,288 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:34,289 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'j93ZF02nifbDWsMXtCQzhg52E7pfrYJv4oTNTwqKdvA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:34,289 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378995628573356","quoteToken":"Z4hdf4FVc_ge1txjaYEJzWrYMGGMBKxUqn_Zkv1sXc9kiRva52xbRxZ4btJu6_wCEUTRLgrMngn7opmGhYP7hZyAkDYXmYwJLEwDckX2XqivNLC5gZvLcxzfvpk9Y4iECSYxKJHhq8ikJxG3NbUwHw","text":"5月19日13時半\n販促デジタル部MTG\n30分"},"webhookEventId":"01JTVZG89Y5F3HDK6VQADHZ82W","deliveryContext":{"isRedelivery":false},"timestamp":1746843213886,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"a491cee902a347dca7ebcf20a3a79ae5","mode":"active"}]}
2025-05-10 11:13:34,290 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:13:34,290 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:13:34,291 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:34,291 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'j93ZF02nifbDWsMXtCQzhg52E7pfrYJv4oTNTwqKdvA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:34,291 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560378995628573356","quoteToken":"Z4hdf4FVc_ge1txjaYEJzWrYMGGMBKxUqn_Zkv1sXc9kiRva52xbRxZ4btJu6_wCEUTRLgrMngn7opmGhYP7hZyAkDYXmYwJLEwDckX2XqivNLC5gZvLcxzfvpk9Y4iECSYxKJHhq8ikJxG3NbUwHw","text":"5月19日13時半\n販促デジタル部MTG\n30分"},"webhookEventId":"01JTVZG89Y5F3HDK6VQADHZ82W","deliveryContext":{"isRedelivery":false},"timestamp":1746843213886,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"a491cee902a347dca7ebcf20a3a79ae5","mode":"active"}]}
2025-05-10 11:13:34,292 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:13:34,292 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:34,292 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:13:34.292401+09:00
2025-05-10 11:13:34,293 - message_parser - DEBUG - メッセージ解析結果: add
2025-05-10 11:13:34,293 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:34,293 - message_parser - DEBUG - X月Y日Z時半パターン: 2025-05-19 13:30:00+09:00 から 2025-05-19 14:00:00+09:00
2025-05-10 11:13:34,293 - message_parser - DEBUG - 時間抽出開始: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:34,293 - message_parser - DEBUG - タイトル抽出開始: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:34,293 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:34,293 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:13:34,294 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日13時半
販促でじたる部MTG
30分
2025-05-10 11:13:34,294 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:13:34,294 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'add', 'title': '販促ﾃﾞｼﾞﾀﾙ部MTG', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 13, 30, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 14, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:13:34,299 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:13:34,299 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:13:34,300 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:13:34,300 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:13:34,861 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:13:34,861 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:13:34,862 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:13:34,862 - __main__ - DEBUG - 予定の作成を開始
2025-05-10 11:13:34,885 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T13%3A30%3A00%2B09%3A00&timeMax=2025-05-19T14%3A00%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:13:35,151 - __main__ - DEBUG - LINEへの返信を開始: ⚠️ この時間帯に既に予定が存在します：
- 販促デジタル部MTG (13:00～14:00)
- 販促ﾃﾞｼﾞﾀﾙ部MTG (13:30～14:00)

それでも追加しますか？
2025-05-10 11:13:35,152 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='⚠️ この時間帯に既に予定が存在します：\n- 販促デジタル部MTG (13:00～14:00)\n- 販促ﾃﾞｼﾞﾀﾙ部MTG (13:30～14:00)\n\nそれでも追加しますか？', emojis=None, quote_token=None)]
2025-05-10 11:13:35,218 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:13:35,218 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:13:35,219 - __main__ - INFO - Request processed in 0.93 seconds
2025-05-10 11:13:35,219 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:13:35,219 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:13:35,220 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:13:35] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:13:38,074 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:38,075 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '565', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'POSG/jHQF1ZKYDDPS5xsTGDggXWHRF28vpq2zN9mAD0=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:38,075 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379001484083668","quoteToken":"WA_OhD3W21jACRdkzsoeoxHa9H_ch5d4gOpS11RP-WyjNrcDJ0oqc7HVOLyr6JLCCwc8wFoFBZYH0CgkBVM_EcpTIywoZsezrJaNJtlNOUqWNX7OJgVmtezfANl7efvkTXZhGWe6r31obK_MLFBMhA","text":"いいえ"},"webhookEventId":"01JTVZGC0VSX9EZFWS2SJ0GQH5","deliveryContext":{"isRedelivery":false},"timestamp":1746843217441,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"0627851821dd46909d2981cdb291f528","mode":"active"}]}
2025-05-10 11:13:38,076 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:13:38,076 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:13:38,077 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:38,077 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '565', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'POSG/jHQF1ZKYDDPS5xsTGDggXWHRF28vpq2zN9mAD0=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:38,077 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379001484083668","quoteToken":"WA_OhD3W21jACRdkzsoeoxHa9H_ch5d4gOpS11RP-WyjNrcDJ0oqc7HVOLyr6JLCCwc8wFoFBZYH0CgkBVM_EcpTIywoZsezrJaNJtlNOUqWNX7OJgVmtezfANl7efvkTXZhGWe6r31obK_MLFBMhA","text":"いいえ"},"webhookEventId":"01JTVZGC0VSX9EZFWS2SJ0GQH5","deliveryContext":{"isRedelivery":false},"timestamp":1746843217441,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"0627851821dd46909d2981cdb291f528","mode":"active"}]}
2025-05-10 11:13:38,078 - __main__ - DEBUG - LINEへの返信を開始: 予定の追加をキャンセルしました。
2025-05-10 11:13:38,078 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定の追加をキャンセルしました。', emojis=None, quote_token=None)]
2025-05-10 11:13:38,174 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:13:38,174 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:13:38,175 - __main__ - INFO - Request processed in 0.10 seconds
2025-05-10 11:13:38,175 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:13:38,175 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:13:38,175 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:13:38] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:13:47,325 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:47,325 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '586', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '0uYOzBSdUzRUbBUS94RPj3KTMVWQuUQFURGbiVa/1Gc=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:47,325 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379018176626724","quoteToken":"TLkPDm1VN_IfWAQj12nBKDALehsJwcPy9lgv6Dq2Tj2cJJ1e2kjtO4_2rG3WmGxAZf7UarWuic23b0CiWUDIAB6gv-KXyc_cx2VOA3MBslYcD3G2KiHYHjAcoRDbM7oz6W3BF120hXOHzQMmjLUDeQ","text":"5月19日の予定を教えて"},"webhookEventId":"01JTVZGN33DNTH07T5P4M3N7WZ","deliveryContext":{"isRedelivery":false},"timestamp":1746843227215,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"47f2128b95c4452e8a28ce452bd39755","mode":"active"}]}
2025-05-10 11:13:47,326 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:13:47,327 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:13:47,327 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:13:47,327 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '586', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '0uYOzBSdUzRUbBUS94RPj3KTMVWQuUQFURGbiVa/1Gc=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:13:47,327 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379018176626724","quoteToken":"TLkPDm1VN_IfWAQj12nBKDALehsJwcPy9lgv6Dq2Tj2cJJ1e2kjtO4_2rG3WmGxAZf7UarWuic23b0CiWUDIAB6gv-KXyc_cx2VOA3MBslYcD3G2KiHYHjAcoRDbM7oz6W3BF120hXOHzQMmjLUDeQ","text":"5月19日の予定を教えて"},"webhookEventId":"01JTVZGN33DNTH07T5P4M3N7WZ","deliveryContext":{"isRedelivery":false},"timestamp":1746843227215,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"47f2128b95c4452e8a28ce452bd39755","mode":"active"}]}
2025-05-10 11:13:47,328 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:13:47,328 - message_parser - DEBUG - 正規化後のメッセージ: 5月19日の予定を教えて
2025-05-10 11:13:47,328 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:13:47.328334+09:00
2025-05-10 11:13:47,328 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:13:47,328 - message_parser - DEBUG - 時間抽出開始: 5月19日の予定を教えて
2025-05-10 11:13:47,328 - message_parser - DEBUG - X月Y日パターン: 2025-05-19 00:00:00+09:00 から 2025-05-19 23:59:00+09:00
2025-05-10 11:13:47,328 - message_parser - DEBUG - 時間抽出開始: 5月19日の予定を教えて
2025-05-10 11:13:47,329 - message_parser - DEBUG - タイトル抽出開始: 5月19日の予定を教えて
2025-05-10 11:13:47,329 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日の予定を教えて
2025-05-10 11:13:47,329 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:13:47,329 - message_parser - DEBUG - 繰り返し情報を抽出: 5月19日の予定を教えて
2025-05-10 11:13:47,329 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:13:47,329 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 19, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 19, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:13:47,334 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:13:47,334 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:13:47,336 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:13:47,336 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:13:47,999 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:13:48,000 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:13:48,002 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:13:48,002 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:13:48,010 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-19T00%3A00%3A00%2B09%3A00&timeMax=2025-05-19T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:13:48,288 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/19（月）
━━━━━━━━━━
1. 販促デジタル部MTG
   🕘 13:00～14:00

2. 販促ﾃﾞｼﾞﾀﾙ部MTG
   🕘 13:30～14:00

━━━━━━━━━━
2025-05-10 11:13:48,288 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/19（月）\n━━━━━━━━━━\n1. 販促デジタル部MTG\n   🕘 13:00～14:00\n\n2. 販促ﾃﾞｼﾞﾀﾙ部MTG\n   🕘 13:30～14:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:13:48,363 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:13:48,363 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:13:48,364 - __main__ - INFO - Request processed in 1.04 seconds
2025-05-10 11:13:48,365 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:13:48,365 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:13:48,365 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:13:48] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:14:09,041 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:14:09,042 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'gzDx+6GhZdhp5FAyrdz8TQyxjgz8Bx9KKCHBGfpSxYA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:14:09,042 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379053543784773","quoteToken":"5scqZcgDm0gOcNzThSiGu1s5--unZx3Scwu_WN-o71cjvnNnJaz514vqyCYtUmCX9wWIK94i9Mv5MY0nRgRNPrZUyAA0jeEeDy8pbd6-1FOT_kE53cyIQqZn998zsW5W-057xGiaiIqAmH6u9P1q3w","text":"今週の予定を教えて"},"webhookEventId":"01JTVZHA8SCT9C0GBRG8J3HAME","deliveryContext":{"isRedelivery":false},"timestamp":1746843248414,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"e77301ed65e04feeb0e6a1157c6c8ec5","mode":"active"}]}
2025-05-10 11:14:09,042 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:14:09,043 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:14:09,043 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:14:09,043 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'gzDx+6GhZdhp5FAyrdz8TQyxjgz8Bx9KKCHBGfpSxYA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:14:09,044 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379053543784773","quoteToken":"5scqZcgDm0gOcNzThSiGu1s5--unZx3Scwu_WN-o71cjvnNnJaz514vqyCYtUmCX9wWIK94i9Mv5MY0nRgRNPrZUyAA0jeEeDy8pbd6-1FOT_kE53cyIQqZn998zsW5W-057xGiaiIqAmH6u9P1q3w","text":"今週の予定を教えて"},"webhookEventId":"01JTVZHA8SCT9C0GBRG8J3HAME","deliveryContext":{"isRedelivery":false},"timestamp":1746843248414,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"e77301ed65e04feeb0e6a1157c6c8ec5","mode":"active"}]}
2025-05-10 11:14:09,044 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:14:09,044 - message_parser - DEBUG - 正規化後のメッセージ: 今週の予定を教えて
2025-05-10 11:14:09,044 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:14:09.044763+09:00
2025-05-10 11:14:09,045 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:14:09,045 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:14:09,045 - message_parser - DEBUG - 日付のみの時間情報: 2025-05-10 00:00:00+09:00 から 2025-05-10 23:59:00+09:00
2025-05-10 11:14:09,046 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:14:09,046 - message_parser - DEBUG - タイトル抽出開始: 今週の予定を教えて
2025-05-10 11:14:09,046 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:14:09,046 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:14:09,046 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:14:09,046 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:14:09,046 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': '今週の予定を教えて', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 10, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 10, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:14:09,049 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:14:09,049 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:14:09,049 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:14:09,050 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:14:09,753 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:14:09,753 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:14:09,753 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:14:09,754 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:14:09,761 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-10T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:14:10,045 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/10（土）
━━━━━━━━━━
1. はい
   🕘 00:00～23:59

━━━━━━━━━━
2025-05-10 11:14:10,046 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/10（土）\n━━━━━━━━━━\n1. はい\n   🕘 00:00～23:59\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:14:10,168 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:14:10,173 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:14:10,198 - __main__ - INFO - Request processed in 1.16 seconds
2025-05-10 11:14:10,201 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:14:10,202 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:14:10,202 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:14:10] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:15:40,486 - database - INFO - データベースを初期化しました。
2025-05-10 11:15:40,487 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:15:40,531 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:15:40,531 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:15:51,820 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:15:51,821 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'jV7B4hpD/X7Xko8gsJHHgAXvL3V6qduHtZQ9SFudUGY=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:15:51,821 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379226684391651","quoteToken":"W-Xz4llLs8spqq56z9MhieygrrJNjPPiev-5EndrSyp4KHq0TEP8zz66xLlW5Zq45VXbZG7pVLnH8ojNacYTnZHIhvIPSaFEHEIU8EltHuzZldbbJVDXigTJ8bzhqMbeLGKLKmK6r7gk2FxUE9NdYg","text":"今週の予定を教えて"},"webhookEventId":"01JTVZMENPB37Z6WGVPAM7XC1Z","deliveryContext":{"isRedelivery":false},"timestamp":1746843351539,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"78c04cb8ea384c208836b5990a3ac955","mode":"active"}]}
2025-05-10 11:15:51,826 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:15:51,828 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:15:51,828 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:15:51,828 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'jV7B4hpD/X7Xko8gsJHHgAXvL3V6qduHtZQ9SFudUGY=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:15:51,828 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379226684391651","quoteToken":"W-Xz4llLs8spqq56z9MhieygrrJNjPPiev-5EndrSyp4KHq0TEP8zz66xLlW5Zq45VXbZG7pVLnH8ojNacYTnZHIhvIPSaFEHEIU8EltHuzZldbbJVDXigTJ8bzhqMbeLGKLKmK6r7gk2FxUE9NdYg","text":"今週の予定を教えて"},"webhookEventId":"01JTVZMENPB37Z6WGVPAM7XC1Z","deliveryContext":{"isRedelivery":false},"timestamp":1746843351539,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"78c04cb8ea384c208836b5990a3ac955","mode":"active"}]}
2025-05-10 11:15:51,829 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:15:51,830 - message_parser - DEBUG - 正規化後のメッセージ: 今週の予定を教えて
2025-05-10 11:15:51,830 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:15:51.830257+09:00
2025-05-10 11:15:51,830 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:15:51,830 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:15:51,831 - message_parser - DEBUG - 今週の時間情報: 2025-05-05 00:00:00+09:00 から 2025-05-11 23:59:00+09:00
2025-05-10 11:15:51,831 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:15:51,833 - message_parser - DEBUG - タイトル抽出開始: 今週の予定を教えて
2025-05-10 11:15:51,833 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:15:51,834 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:15:51,834 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:15:51,834 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:15:51,835 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': '今週の予定を教えて', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 5, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 11, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:15:51,840 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:15:51,840 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:15:51,842 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:15:51,842 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:15:52,463 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:15:52,464 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:15:52,464 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:15:52,464 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:15:52,471 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-05T00%3A00%3A00%2B09%3A00&timeMax=2025-05-11T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:15:52,827 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/05（月）
━━━━━━━━━━
1. 片さんとMTG
   🕘 09:00～09:30

2. あｰき
   🕘 11:00～12:00
   📍 ざいん会議

3. 辻さんと電話
   🕘 14:00～15:00

4. めいちゃんさんと蔵前でお茶
   🕘 16:00～17:00

5. ゆかりさんと両国でごはん
   🕘 21:00～22:00

6. 読書会
   🕘 08:00～09:00

7. 今日10時から電えね定例会
   🕘 10:00～23:59

8. 中崎さんとzoom
   🕘 12:00～13:00

9. 今日13時から週次MTG
   🕘 13:00～14:00

10. ぼどげ会
   🕘 20:00～21:00

11. 今日9時から2時間の予定
   🕘 09:00～10:00

12. はい
   🕘 00:00～23:59

13. 大沼さんと清澄白河でごはん
   🕘 17:00～18:00

━━━━━━━━━━
2025-05-10 11:15:52,828 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/05（月）\n━━━━━━━━━━\n1. 片さんとMTG\n   🕘 09:00～09:30\n\n2. あｰき\n   🕘 11:00～12:00\n   📍 ざいん会議\n\n3. 辻さんと電話\n   🕘 14:00～15:00\n\n4. めいちゃんさんと蔵前でお茶\n   🕘 16:00～17:00\n\n5. ゆかりさんと両国でごはん\n   🕘 21:00～22:00\n\n6. 読書会\n   🕘 08:00～09:00\n\n7. 今日10時から電えね定例会\n   🕘 10:00～23:59\n\n8. 中崎さんとzoom\n   🕘 12:00～13:00\n\n9. 今日13時から週次MTG\n   🕘 13:00～14:00\n\n10. ぼどげ会\n   🕘 20:00～21:00\n\n11. 今日9時から2時間の予定\n   🕘 09:00～10:00\n\n12. はい\n   🕘 00:00～23:59\n\n13. 大沼さんと清澄白河でごはん\n   🕘 17:00～18:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:15:52,934 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:15:52,934 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:15:52,935 - __main__ - INFO - Request processed in 1.11 seconds
2025-05-10 11:15:52,935 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:15:52,935 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:15:52,935 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:15:52] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:16:09,818 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:16:09,819 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '596', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'zKamanTDIMd/72xevPwk1Ux6pNnQEKEaNSyP5lYZnHw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:16:09,820 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379256782979534","quoteToken":"mdlIE6_w7QGsPGplBrck6KHG1hAO4_HCv_Abjghy3W0h1ozlL4oMWYClEnrpjEPFeOmQQhNuIwIXKXku1Yrf1DBE9UmziJwruTRAvYhoyLjFnzOzaZXgsJuA4ma7V87HINgC7BTs5LgToVWbhiGrDQ","text":"5月5日12番の予定をキャンセル"},"webhookEventId":"01JTVZN07YW27DXM156VQ3DNZW","deliveryContext":{"isRedelivery":false},"timestamp":1746843369562,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"8f1bcf192aeb4871bd96d7f492396893","mode":"active"}]}
2025-05-10 11:16:09,820 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:16:09,821 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:16:09,821 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:16:09,821 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '596', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'zKamanTDIMd/72xevPwk1Ux6pNnQEKEaNSyP5lYZnHw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:16:09,821 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379256782979534","quoteToken":"mdlIE6_w7QGsPGplBrck6KHG1hAO4_HCv_Abjghy3W0h1ozlL4oMWYClEnrpjEPFeOmQQhNuIwIXKXku1Yrf1DBE9UmziJwruTRAvYhoyLjFnzOzaZXgsJuA4ma7V87HINgC7BTs5LgToVWbhiGrDQ","text":"5月5日12番の予定をキャンセル"},"webhookEventId":"01JTVZN07YW27DXM156VQ3DNZW","deliveryContext":{"isRedelivery":false},"timestamp":1746843369562,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"8f1bcf192aeb4871bd96d7f492396893","mode":"active"}]}
2025-05-10 11:16:09,822 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:16:09,822 - message_parser - DEBUG - 正規化後のメッセージ: 5月5日12番の予定をきゃんせる
2025-05-10 11:16:09,822 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:16:09.822606+09:00
2025-05-10 11:16:09,823 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:16:09,823 - message_parser - DEBUG - 時間抽出開始: 5月5日12番の予定をきゃんせる
2025-05-10 11:16:09,825 - message_parser - DEBUG - X月Y日パターン: 2026-05-05 00:00:00+09:00 から 2026-05-05 23:59:00+09:00
2025-05-10 11:16:09,825 - message_parser - DEBUG - 時間抽出開始: 5月5日12番の予定をきゃんせる
2025-05-10 11:16:09,825 - message_parser - DEBUG - タイトル抽出開始: 5月5日12番の予定をきゃんせる
2025-05-10 11:16:09,825 - message_parser - DEBUG - 繰り返し情報を抽出: 5月5日12番の予定をきゃんせる
2025-05-10 11:16:09,826 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:16:09,826 - message_parser - DEBUG - 繰り返し情報を抽出: 5月5日12番の予定をきゃんせる
2025-05-10 11:16:09,826 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:16:09,826 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2026, 5, 5, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2026, 5, 5, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': 12}
2025-05-10 11:16:09,831 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:16:09,831 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:16:09,832 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:16:09,833 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:16:10,848 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:16:10,848 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:16:10,848 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:16:10,848 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:16:10,853 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2026-05-05T00%3A00%3A00%2B09%3A00&timeMax=2026-05-05T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:16:11,108 - __main__ - DEBUG - LINEへの返信を開始: 指定された日付・時間帯に予定はありません。
2025-05-10 11:16:11,109 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='指定された日付・時間帯に予定はありません。', emojis=None, quote_token=None)]
2025-05-10 11:16:11,162 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:16:11,162 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:16:11,163 - __main__ - INFO - Request processed in 1.34 seconds
2025-05-10 11:16:11,163 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:16:11,163 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:16:11,163 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:16:11] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:17:31,067 - database - INFO - データベースを初期化しました。
2025-05-10 11:17:31,067 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:17:31,072 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:17:31,072 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:18:19,074 - database - INFO - データベースを初期化しました。
2025-05-10 11:18:19,074 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:18:19,270 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:18:19,271 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:18:33,736 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:18:33,737 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'My5HUGudZ75cXaeSLyMhKJToxMoCX0ghcFwh+9GyIDA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:18:33,737 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379497803678005","quoteToken":"1ritRP-PcgQOZr2j240RamMUfmMmtdHgC9IFY3l60CXJ2LZVi87CSk7NfK5K1xfWtvHXz6S7YXE4Eq7hXRIN3NMtUu5LT2LxEY5KPF2CgxIBSKA6krfYNSamOzQd2qLfqF9oEatmqzAE9r5unBQMzA","text":"今週の予定を教えて"},"webhookEventId":"01JTVZSCRANJ2YEZ3RWWWS3B7V","deliveryContext":{"isRedelivery":false},"timestamp":1746843513103,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"835df887b89e42aeb085f55f2003ff62","mode":"active"}]}
2025-05-10 11:18:33,742 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:18:33,743 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:18:33,743 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:18:33,743 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'My5HUGudZ75cXaeSLyMhKJToxMoCX0ghcFwh+9GyIDA=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:18:33,743 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379497803678005","quoteToken":"1ritRP-PcgQOZr2j240RamMUfmMmtdHgC9IFY3l60CXJ2LZVi87CSk7NfK5K1xfWtvHXz6S7YXE4Eq7hXRIN3NMtUu5LT2LxEY5KPF2CgxIBSKA6krfYNSamOzQd2qLfqF9oEatmqzAE9r5unBQMzA","text":"今週の予定を教えて"},"webhookEventId":"01JTVZSCRANJ2YEZ3RWWWS3B7V","deliveryContext":{"isRedelivery":false},"timestamp":1746843513103,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"835df887b89e42aeb085f55f2003ff62","mode":"active"}]}
2025-05-10 11:18:33,744 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:18:33,745 - message_parser - DEBUG - 正規化後のメッセージ: 今週の予定を教えて
2025-05-10 11:18:33,745 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:18:33.745307+09:00
2025-05-10 11:18:33,745 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:18:33,745 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:18:33,746 - message_parser - DEBUG - 今週の時間情報: 2025-05-10 00:00:00+09:00 から 2025-05-11 23:59:00+09:00
2025-05-10 11:18:33,746 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:18:33,748 - message_parser - DEBUG - タイトル抽出開始: 今週の予定を教えて
2025-05-10 11:18:33,749 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:18:33,749 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:18:33,749 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:18:33,749 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:18:33,749 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': '今週の予定を教えて', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 10, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 11, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:18:33,754 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:18:33,754 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:18:33,755 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:18:33,755 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:18:34,416 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:18:34,417 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:18:34,417 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:18:34,417 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:18:34,425 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-11T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:18:34,752 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/10（土）
━━━━━━━━━━
1. はい
   🕘 00:00～23:59

2. 大沼さんと清澄白河でごはん
   🕘 17:00～18:00

━━━━━━━━━━
2025-05-10 11:18:34,753 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/10（土）\n━━━━━━━━━━\n1. はい\n   🕘 00:00～23:59\n\n2. 大沼さんと清澄白河でごはん\n   🕘 17:00～18:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:18:34,862 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:18:34,862 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:18:34,862 - __main__ - INFO - Request processed in 1.13 seconds
2025-05-10 11:18:34,862 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:18:34,862 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:18:34,863 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:18:34] "POST /callback HTTP/1.1" 200 -
/Users/kikuchimizuki/Desktop/LINEでカレンダー/venv/lib/python3.9/site-packages/urllib3/__init__.py:35: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
2025-05-10 11:20:36,394 - database - INFO - データベースを初期化しました。
2025-05-10 11:20:36,395 - asyncio - DEBUG - Using selector: KqueueSelector
 * Serving Flask app 'app'
 * Debug mode: off
2025-05-10 11:20:36,568 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:3001
 * Running on http://192.168.0.207:3001
2025-05-10 11:20:36,568 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-05-10 11:20:48,751 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:20:48,752 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'vWQtxaChuUFZhAScP7ogiGh/L0Onwvm2vnL49pGbXCc=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:20:48,752 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379724866519300","quoteToken":"4f4sVrY_xc4pkQZ8WIM4wfg3LIdVx7m6p59vf7pmFBXOavb-Li0o657cjjw7yY6vFc4D-JRU8jlkhEVSHWnMIXez658a66vBNodys7OMgWaNdIT9WQIgLqoPRXnn7qLvTg4l8Ms1ujy4emViEp9JzA","text":"今週の予定を教えて"},"webhookEventId":"01JTVZXGKQNV09YV14QEVY7MHW","deliveryContext":{"isRedelivery":false},"timestamp":1746843648412,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"c62059897a594a09aacd5715772fabc4","mode":"active"}]}
2025-05-10 11:20:48,757 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:20:48,758 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:20:48,758 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:20:48,759 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'vWQtxaChuUFZhAScP7ogiGh/L0Onwvm2vnL49pGbXCc=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:20:48,759 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379724866519300","quoteToken":"4f4sVrY_xc4pkQZ8WIM4wfg3LIdVx7m6p59vf7pmFBXOavb-Li0o657cjjw7yY6vFc4D-JRU8jlkhEVSHWnMIXez658a66vBNodys7OMgWaNdIT9WQIgLqoPRXnn7qLvTg4l8Ms1ujy4emViEp9JzA","text":"今週の予定を教えて"},"webhookEventId":"01JTVZXGKQNV09YV14QEVY7MHW","deliveryContext":{"isRedelivery":false},"timestamp":1746843648412,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"c62059897a594a09aacd5715772fabc4","mode":"active"}]}
2025-05-10 11:20:48,760 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:20:48,761 - message_parser - DEBUG - 正規化後のメッセージ: 今週の予定を教えて
2025-05-10 11:20:48,761 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:20:48.761388+09:00
2025-05-10 11:20:48,762 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:20:48,762 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:20:48,762 - message_parser - DEBUG - 今週の時間情報: 2025-05-10 00:00:00+09:00 から 2025-05-11 23:59:00+09:00
2025-05-10 11:20:48,762 - message_parser - DEBUG - 時間抽出開始: 今週の予定を教えて
2025-05-10 11:20:48,764 - message_parser - DEBUG - タイトル抽出開始: 今週の予定を教えて
2025-05-10 11:20:48,765 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:20:48,765 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:20:48,765 - message_parser - DEBUG - 繰り返し情報を抽出: 今週の予定を教えて
2025-05-10 11:20:48,766 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:20:48,766 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': '今週の予定を教えて', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 10, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 11, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:20:48,772 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:20:48,772 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:20:48,774 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:20:48,775 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:20:49,368 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:20:49,372 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:20:49,372 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:20:49,373 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:20:49,380 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-11T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:20:49,765 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/10（土）
━━━━━━━━━━
1. はい
   🕘 00:00～23:59

━━━━━━━━━━
📅 2025/05/11（日）
━━━━━━━━━━
1. 大沼さんと清澄白河でごはん
   🕘 17:00～18:00

━━━━━━━━━━
2025-05-10 11:20:49,765 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/10（土）\n━━━━━━━━━━\n1. はい\n   🕘 00:00～23:59\n\n━━━━━━━━━━\n📅 2025/05/11（日）\n━━━━━━━━━━\n1. 大沼さんと清澄白河でごはん\n   🕘 17:00～18:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:20:49,905 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:20:49,905 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:20:49,906 - __main__ - INFO - Request processed in 1.15 seconds
2025-05-10 11:20:49,906 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:20:49,906 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:20:49,906 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:20:49] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:21:06,408 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:21:06,408 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '596', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'vFGPEozMWWRkw9L4JlfWTPqmoi0PNvyM3IoeeW4n3B8=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:21:06,408 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379754428236192","quoteToken":"AdfR8DJVQY4a6GMlQ8w9vxdQniqUW1Rq2MMtdnBzB-BeuzVtSIjuSfBkmzFwMmeaYotrB_fQuIfXa6gIfBnEO4ThK-TaGtZeTF3r8-oasySeIKhlMLNnuNGw_8kZIfefKAsAx5cNznIJt9ok29-OHA","text":"5月10日1番の予定をキャンセル"},"webhookEventId":"01JTVZY1S02C0J8WH3QPBPMN3R","deliveryContext":{"isRedelivery":false},"timestamp":1746843666181,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"157ad5aea35c489ea57c32b1e437693b","mode":"active"}]}
2025-05-10 11:21:06,409 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:21:06,410 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:21:06,410 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:21:06,410 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '596', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'vFGPEozMWWRkw9L4JlfWTPqmoi0PNvyM3IoeeW4n3B8=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:21:06,410 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379754428236192","quoteToken":"AdfR8DJVQY4a6GMlQ8w9vxdQniqUW1Rq2MMtdnBzB-BeuzVtSIjuSfBkmzFwMmeaYotrB_fQuIfXa6gIfBnEO4ThK-TaGtZeTF3r8-oasySeIKhlMLNnuNGw_8kZIfefKAsAx5cNznIJt9ok29-OHA","text":"5月10日1番の予定をキャンセル"},"webhookEventId":"01JTVZY1S02C0J8WH3QPBPMN3R","deliveryContext":{"isRedelivery":false},"timestamp":1746843666181,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"157ad5aea35c489ea57c32b1e437693b","mode":"active"}]}
2025-05-10 11:21:06,411 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:21:06,412 - message_parser - DEBUG - 正規化後のメッセージ: 5月10日1番の予定をきゃんせる
2025-05-10 11:21:06,412 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:21:06.412137+09:00
2025-05-10 11:21:06,412 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:21:06,413 - message_parser - DEBUG - 時間抽出開始: 5月10日1番の予定をきゃんせる
2025-05-10 11:21:06,414 - message_parser - DEBUG - X月Y日パターン: 2025-05-10 00:00:00+09:00 から 2025-05-10 23:59:00+09:00
2025-05-10 11:21:06,414 - message_parser - DEBUG - 時間抽出開始: 5月10日1番の予定をきゃんせる
2025-05-10 11:21:06,415 - message_parser - DEBUG - タイトル抽出開始: 5月10日1番の予定をきゃんせる
2025-05-10 11:21:06,415 - message_parser - DEBUG - 繰り返し情報を抽出: 5月10日1番の予定をきゃんせる
2025-05-10 11:21:06,415 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:21:06,415 - message_parser - DEBUG - 繰り返し情報を抽出: 5月10日1番の予定をきゃんせる
2025-05-10 11:21:06,415 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:21:06,415 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 10, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 10, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': 1}
2025-05-10 11:21:06,420 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:21:06,420 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:21:06,422 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:21:06,422 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:21:07,097 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:21:07,098 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:21:07,098 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:21:07,098 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:21:07,108 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-10T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:21:07,422 - googleapiclient.discovery - DEBUG - URL being requested: DELETE https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events/m4okl293gl5b4gs2unjlvbq79k?
2025-05-10 11:21:08,011 - calendar_operations - INFO - 予定を削除しました: m4okl293gl5b4gs2unjlvbq79k
2025-05-10 11:21:08,014 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-10T00%3A00%3A00%2B09%3A00&timeMax=2025-05-10T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:21:08,275 - __main__ - DEBUG - LINEへの返信を開始: 予定「はい」を削除しました。

この日の予定は全て削除されました。
2025-05-10 11:21:08,276 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「はい」を削除しました。\n\nこの日の予定は全て削除されました。', emojis=None, quote_token=None)]
2025-05-10 11:21:08,357 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:21:08,358 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:21:08,358 - __main__ - INFO - Request processed in 1.95 seconds
2025-05-10 11:21:08,358 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:21:08,359 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:21:08,359 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:21:08] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:21:26,842 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:21:26,842 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'BYsRQBUMvCrr9MXcIXiVcq76b9GemQ3TRK/viGG6Kmw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:21:26,843 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379788687835227","quoteToken":"y3W8gTYPMSuT8VsZouN7oPoipvn9oGQqXHbT6BpP17Vx8bnw_kKOLhSwP3d01DvIB4QCrWJ13HayrJJCEGjXqfqAuDoJGlWiddFW7ySD7yUvCdED8D5TiAisdjmw3eY_yRuy0RL0LgONFqa_7YLxdA","text":"来週の予定を教えて"},"webhookEventId":"01JTVZYNVVFE5WSCAC83ZGQYDV","deliveryContext":{"isRedelivery":false},"timestamp":1746843686612,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1b19072b3ca04487af30b438031a2747","mode":"active"}]}
2025-05-10 11:21:26,843 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:21:26,844 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:21:26,845 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:21:26,845 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '583', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'BYsRQBUMvCrr9MXcIXiVcq76b9GemQ3TRK/viGG6Kmw=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:21:26,845 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379788687835227","quoteToken":"y3W8gTYPMSuT8VsZouN7oPoipvn9oGQqXHbT6BpP17Vx8bnw_kKOLhSwP3d01DvIB4QCrWJ13HayrJJCEGjXqfqAuDoJGlWiddFW7ySD7yUvCdED8D5TiAisdjmw3eY_yRuy0RL0LgONFqa_7YLxdA","text":"来週の予定を教えて"},"webhookEventId":"01JTVZYNVVFE5WSCAC83ZGQYDV","deliveryContext":{"isRedelivery":false},"timestamp":1746843686612,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"1b19072b3ca04487af30b438031a2747","mode":"active"}]}
2025-05-10 11:21:26,846 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:21:26,847 - message_parser - DEBUG - 正規化後のメッセージ: 来週の予定を教えて
2025-05-10 11:21:26,847 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:21:26.846934+09:00
2025-05-10 11:21:26,847 - message_parser - DEBUG - メッセージ解析結果: read
2025-05-10 11:21:26,847 - message_parser - DEBUG - 時間抽出開始: 来週の予定を教えて
2025-05-10 11:21:26,847 - message_parser - DEBUG - 来週の時間情報: 2025-05-12 00:00:00+09:00 から 2025-05-18 23:59:00+09:00
2025-05-10 11:21:26,847 - message_parser - DEBUG - 時間抽出開始: 来週の予定を教えて
2025-05-10 11:21:26,848 - message_parser - DEBUG - タイトル抽出開始: 来週の予定を教えて
2025-05-10 11:21:26,848 - message_parser - DEBUG - 繰り返し情報を抽出: 来週の予定を教えて
2025-05-10 11:21:26,848 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:21:26,848 - message_parser - DEBUG - 繰り返し情報を抽出: 来週の予定を教えて
2025-05-10 11:21:26,848 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:21:26,848 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'read', 'title': '来週の予定を教えて', 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 12, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 18, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': None}
2025-05-10 11:21:26,853 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:21:26,853 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:21:26,855 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:21:26,855 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:21:27,414 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:21:27,415 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:21:27,415 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:21:27,416 - __main__ - DEBUG - 予定の検索を開始
2025-05-10 11:21:27,424 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-12T00%3A00%3A00%2B09%3A00&timeMax=2025-05-18T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:21:27,785 - __main__ - DEBUG - LINEへの返信を開始: 📅 2025/05/12（月）
━━━━━━━━━━
1. 積水化学向けAISEG3サイト打合せ オンライン
   🕘 11:00～12:00

2. 販促デジタル部週次MTG
   🕘 13:30～14:00
   📍 オンライン

3. 販促企画部MTG A
   🕘 14:00～15:00

4. 電エネ横断MTG 京橋
   🕘 16:00～17:00

━━━━━━━━━━
📅 2025/05/13（火）
━━━━━━━━━━
1. 電エネ年間スケジュールMTG 門真
   🕘 09:00～10:00
   📍 5

2. web相談 45
   🕘 13:00～13:45
   📍 オンライン

3. コンプラMTG
   🕘 13:00～14:00
   📍 5

4. 1on1を
   🕘 15:00～16:00
   📍 5

5. まんしょんHA打合せ
   🕘 16:00～17:00
   📍 5

6. 博報堂打合せ
   🕘 17:00～18:00

━━━━━━━━━━
📅 2025/05/14（水）
━━━━━━━━━━
1. 電えね定例会
   🕘 10:00～11:00

2. まんしょんいんたｰほん内部MTG
1間半
京橋
   🕘 11:00～12:30
   📍 京橋

━━━━━━━━━━
📅 2025/05/15（木）
━━━━━━━━━━
1. こみゅ室定例会
   🕘 13:00～15:30

2. 令和電気設備運動
   🕘 16:30～17:30

━━━━━━━━━━
📅 2025/05/16（金）
━━━━━━━━━━
予定はありません。
━━━━━━━━━━
📅 2025/05/17（土）
━━━━━━━━━━
予定はありません。
━━━━━━━━━━
📅 2025/05/18（日）
━━━━━━━━━━
予定はありません。
━━━━━━━━━━
2025-05-10 11:21:27,786 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='📅 2025/05/12（月）\n━━━━━━━━━━\n1. 積水化学向けAISEG3サイト打合せ オンライン\n   🕘 11:00～12:00\n\n2. 販促デジタル部週次MTG\n   🕘 13:30～14:00\n   📍 オンライン\n\n3. 販促企画部MTG A\n   🕘 14:00～15:00\n\n4. 電エネ横断MTG 京橋\n   🕘 16:00～17:00\n\n━━━━━━━━━━\n📅 2025/05/13（火）\n━━━━━━━━━━\n1. 電エネ年間スケジュールMTG 門真\n   🕘 09:00～10:00\n   📍 5\n\n2. web相談 45\n   🕘 13:00～13:45\n   📍 オンライン\n\n3. コンプラMTG\n   🕘 13:00～14:00\n   📍 5\n\n4. 1on1を\n   🕘 15:00～16:00\n   📍 5\n\n5. まんしょんHA打合せ\n   🕘 16:00～17:00\n   📍 5\n\n6. 博報堂打合せ\n   🕘 17:00～18:00\n\n━━━━━━━━━━\n📅 2025/05/14（水）\n━━━━━━━━━━\n1. 電えね定例会\n   🕘 10:00～11:00\n\n2. まんしょんいんたｰほん内部MTG\n1間半\n京橋\n   🕘 11:00～12:30\n   📍 京橋\n\n━━━━━━━━━━\n📅 2025/05/15（木）\n━━━━━━━━━━\n1. こみゅ室定例会\n   🕘 13:00～15:30\n\n2. 令和電気設備運動\n   🕘 16:30～17:30\n\n━━━━━━━━━━\n📅 2025/05/16（金）\n━━━━━━━━━━\n予定はありません。\n━━━━━━━━━━\n📅 2025/05/17（土）\n━━━━━━━━━━\n予定はありません。\n━━━━━━━━━━\n📅 2025/05/18（日）\n━━━━━━━━━━\n予定はありません。\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:21:27,880 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:21:27,884 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:21:27,904 - __main__ - INFO - Request processed in 1.06 seconds
2025-05-10 11:21:27,905 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:21:27,905 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:21:27,905 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:21:27] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:23:22,244 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:23:22,244 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '602', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '0g6rzG4p4kFTogmQtR2Sv/pj2d4RJT08SmWfMVYODSQ=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:23:22,245 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379982028210468","quoteToken":"HD0pKJB6_I1iglCnMI-CIlYvxEIpRPb0TTZVCn04q3peGz7miFGBNprHdNB4QR1MsXlCzHJofyoUkK1BgHXBlrsj8YY1WUsYtUARfpLaRrvCoLottJPWO5VnEAV0mahTZ62vLZqdOXCPOrp9VKIxug","text":"5月14日2番の予定をキャンセルして"},"webhookEventId":"01JTW026GT43D5V83ASKXW09QP","deliveryContext":{"isRedelivery":false},"timestamp":1746843801829,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"bba4fce6d4c9469ea3ec494e05b6de23","mode":"active"}]}
2025-05-10 11:23:22,245 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:23:22,246 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:23:22,246 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:23:22,246 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '602', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': '0g6rzG4p4kFTogmQtR2Sv/pj2d4RJT08SmWfMVYODSQ=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:23:22,246 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560379982028210468","quoteToken":"HD0pKJB6_I1iglCnMI-CIlYvxEIpRPb0TTZVCn04q3peGz7miFGBNprHdNB4QR1MsXlCzHJofyoUkK1BgHXBlrsj8YY1WUsYtUARfpLaRrvCoLottJPWO5VnEAV0mahTZ62vLZqdOXCPOrp9VKIxug","text":"5月14日2番の予定をキャンセルして"},"webhookEventId":"01JTW026GT43D5V83ASKXW09QP","deliveryContext":{"isRedelivery":false},"timestamp":1746843801829,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"bba4fce6d4c9469ea3ec494e05b6de23","mode":"active"}]}
2025-05-10 11:23:22,247 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:23:22,247 - message_parser - DEBUG - 正規化後のメッセージ: 5月14日2番の予定をきゃんせるして
2025-05-10 11:23:22,247 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:23:22.247670+09:00
2025-05-10 11:23:22,248 - message_parser - DEBUG - メッセージ解析結果: delete
2025-05-10 11:23:22,248 - message_parser - DEBUG - 時間抽出開始: 5月14日2番の予定をきゃんせるして
2025-05-10 11:23:22,248 - message_parser - DEBUG - X月Y日パターン: 2025-05-14 00:00:00+09:00 から 2025-05-14 23:59:00+09:00
2025-05-10 11:23:22,248 - message_parser - DEBUG - 時間抽出開始: 5月14日2番の予定をきゃんせるして
2025-05-10 11:23:22,248 - message_parser - DEBUG - タイトル抽出開始: 5月14日2番の予定をきゃんせるして
2025-05-10 11:23:22,248 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日2番の予定をきゃんせるして
2025-05-10 11:23:22,249 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:23:22,249 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日2番の予定をきゃんせるして
2025-05-10 11:23:22,249 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:23:22,249 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'delete', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 14, 0, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 14, 23, 59, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': True, 'delete_index': 2}
2025-05-10 11:23:22,253 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:23:22,253 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:23:22,255 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:23:22,255 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:23:22,847 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:23:22,848 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:23:22,848 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:23:22,848 - __main__ - DEBUG - 予定の削除を開始
2025-05-10 11:23:22,874 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-14T00%3A00%3A00%2B09%3A00&timeMax=2025-05-14T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:23:23,186 - googleapiclient.discovery - DEBUG - URL being requested: DELETE https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events/2hvrs3jrfvkpoug8ditrv5c794?
2025-05-10 11:23:23,693 - calendar_operations - INFO - 予定を削除しました: 2hvrs3jrfvkpoug8ditrv5c794
2025-05-10 11:23:23,702 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/mmms.dy.23%40gmail.com/events?timeMin=2025-05-14T00%3A00%3A00%2B09%3A00&timeMax=2025-05-14T23%3A59%3A00%2B09%3A00&singleEvents=true&orderBy=startTime&alt=json
2025-05-10 11:23:23,985 - __main__ - DEBUG - LINEへの返信を開始: 予定「まんしょんいんたｰほん内部MTG
1間半
京橋」を削除しました。

残りの予定：
📅 2025/05/14（水）
━━━━━━━━━━
1. 電えね定例会
   🕘 10:00～11:00

━━━━━━━━━━
2025-05-10 11:23:23,985 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='予定「まんしょんいんたｰほん内部MTG\n1間半\n京橋」を削除しました。\n\n残りの予定：\n📅 2025/05/14（水）\n━━━━━━━━━━\n1. 電えね定例会\n   🕘 10:00～11:00\n\n━━━━━━━━━━', emojis=None, quote_token=None)]
2025-05-10 11:23:24,058 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:23:24,061 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:23:24,068 - __main__ - INFO - Request processed in 1.82 seconds
2025-05-10 11:23:24,068 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:23:24,068 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:23:24,069 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:23:24] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:24:00,979 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:24:00,979 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'MuZseO2a/yc3JuU/2Agq8BZbZnd2DCw7+IzfsXiYNO8=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:24:00,980 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560380046771225181","quoteToken":"hpS7dgzBgTGO6Xw5Inzqw_49-fnzsO7YEJWXGUfHMColFj0qv8bRMe9-UBRG39vtA8BgtPz-YFyeCKWf_VVrQE8YSAek6wQCMkfFspFYYgLzQgplfvT6_LEkB7VWjzhRZqN5BWoKD1b0yDmgWDziNA","text":"5月14日1番の予定を1時間半に変更して"},"webhookEventId":"01JTW03CAKEXWJYWF3WY4W7AQ2","deliveryContext":{"isRedelivery":false},"timestamp":1746843840344,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"833f78712dcb4e35a3f390ca4b5e5ae0","mode":"active"}]}
2025-05-10 11:24:00,980 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:24:00,981 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:24:00,981 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:24:00,981 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'MuZseO2a/yc3JuU/2Agq8BZbZnd2DCw7+IzfsXiYNO8=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:24:00,981 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560380046771225181","quoteToken":"hpS7dgzBgTGO6Xw5Inzqw_49-fnzsO7YEJWXGUfHMColFj0qv8bRMe9-UBRG39vtA8BgtPz-YFyeCKWf_VVrQE8YSAek6wQCMkfFspFYYgLzQgplfvT6_LEkB7VWjzhRZqN5BWoKD1b0yDmgWDziNA","text":"5月14日1番の予定を1時間半に変更して"},"webhookEventId":"01JTW03CAKEXWJYWF3WY4W7AQ2","deliveryContext":{"isRedelivery":false},"timestamp":1746843840344,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"833f78712dcb4e35a3f390ca4b5e5ae0","mode":"active"}]}
2025-05-10 11:24:00,982 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:24:00,983 - message_parser - DEBUG - 正規化後のメッセージ: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:24:00,983 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:24:00.983174+09:00
2025-05-10 11:24:00,983 - message_parser - DEBUG - メッセージ解析結果: update
2025-05-10 11:24:00,983 - message_parser - DEBUG - 時間抽出開始: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:24:00,984 - message_parser - DEBUG - X月Y日N時間パターン: 2025-05-14 09:00:00+09:00 から 2025-05-14 10:00:00+09:00
2025-05-10 11:24:00,984 - message_parser - DEBUG - 時間抽出開始: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:24:00,984 - message_parser - DEBUG - タイトル抽出開始: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:24:00,984 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:24:00,985 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:24:00,985 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:24:00,985 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:24:00,985 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'update', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 14, 9, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 14, 10, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:24:00,989 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:24:00,990 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:24:00,991 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:24:00,991 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:24:01,587 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:24:01,588 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:24:01,588 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:24:01,589 - __main__ - WARNING - 未対応の操作タイプ: update
2025-05-10 11:24:01,590 - __main__ - DEBUG - LINEへの返信を開始: すみません、その操作はまだ実装されていません。
2025-05-10 11:24:01,590 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='すみません、その操作はまだ実装されていません。', emojis=None, quote_token=None)]
2025-05-10 11:24:01,673 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:24:01,673 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:24:01,674 - __main__ - INFO - Request processed in 0.69 seconds
2025-05-10 11:24:01,674 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:24:01,674 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:24:01,674 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:24:01] "POST /callback HTTP/1.1" 200 -
2025-05-10 11:27:24,757 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:27:24,757 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'OJv8Qqw2AnVFAtNbDWSwYIgFO2PdkjCFWbBtTf4bSJE=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:27:24,758 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560380388740956178","quoteToken":"w6-gkWdqZERXVfGqwj7EYOM8p8wC1hQOdtGpiOzLTdLh_pt7VsqGJz8Y_v4QQr1PNhEBBtK1acXoDkk07NIBm6n1lC9adpjYOKaFwzg1Sar6r8LG64wm30THDj7hC4UcNIZ8ztIcuvl67MzucvvUgw","text":"5月14日1番の予定を1時間半に変更して"},"webhookEventId":"01JTW09KBKM0KVX5Y3GM2EGV9V","deliveryContext":{"isRedelivery":false},"timestamp":1746844044108,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ce14be63570844598c2d154140ba32a1","mode":"active"}]}
2025-05-10 11:27:24,758 - asyncio - DEBUG - Using selector: KqueueSelector
2025-05-10 11:27:24,759 - __main__ - INFO - Webhookの処理を開始
2025-05-10 11:27:24,759 - __main__ - DEBUG - Request: POST https://3656-113-32-186-176.ngrok-free.app/callback
2025-05-10 11:27:24,759 - __main__ - DEBUG - Headers: {'Host': '3656-113-32-186-176.ngrok-free.app', 'User-Agent': 'LineBotWebhook/2.0', 'Content-Length': '606', 'Content-Type': 'application/json; charset=utf-8', 'X-Forwarded-For': '147.92.149.169', 'X-Forwarded-Host': '3656-113-32-186-176.ngrok-free.app', 'X-Forwarded-Proto': 'https', 'X-Line-Signature': 'OJv8Qqw2AnVFAtNbDWSwYIgFO2PdkjCFWbBtTf4bSJE=', 'Accept-Encoding': 'gzip'}
2025-05-10 11:27:24,759 - __main__ - DEBUG - Body: {"destination":"Ud91468152e7f055e3ccdeea0d1ecd26c","events":[{"type":"message","message":{"type":"text","id":"560380388740956178","quoteToken":"w6-gkWdqZERXVfGqwj7EYOM8p8wC1hQOdtGpiOzLTdLh_pt7VsqGJz8Y_v4QQr1PNhEBBtK1acXoDkk07NIBm6n1lC9adpjYOKaFwzg1Sar6r8LG64wm30THDj7hC4UcNIZ8ztIcuvl67MzucvvUgw","text":"5月14日1番の予定を1時間半に変更して"},"webhookEventId":"01JTW09KBKM0KVX5Y3GM2EGV9V","deliveryContext":{"isRedelivery":false},"timestamp":1746844044108,"source":{"type":"user","userId":"U6a99e85de7d2922e21b6769f9c98fd5b"},"replyToken":"ce14be63570844598c2d154140ba32a1","mode":"active"}]}
2025-05-10 11:27:24,760 - __main__ - DEBUG - メッセージの解析を開始
2025-05-10 11:27:24,760 - message_parser - DEBUG - 正規化後のメッセージ: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:27:24,761 - message_parser - DEBUG - 現在時刻: 2025-05-10 11:27:24.760804+09:00
2025-05-10 11:27:24,761 - message_parser - DEBUG - メッセージ解析結果: update
2025-05-10 11:27:24,761 - message_parser - DEBUG - 時間抽出開始: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:27:24,761 - message_parser - DEBUG - X月Y日N時間パターン: 2025-05-14 09:00:00+09:00 から 2025-05-14 10:00:00+09:00
2025-05-10 11:27:24,761 - message_parser - DEBUG - 時間抽出開始: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:27:24,761 - message_parser - DEBUG - タイトル抽出開始: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:27:24,761 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:27:24,762 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:27:24,762 - message_parser - DEBUG - 繰り返し情報を抽出: 5月14日1番の予定を1時間半に変更して
2025-05-10 11:27:24,762 - message_parser - DEBUG - 抽出された繰り返し情報: None
2025-05-10 11:27:24,762 - __main__ - DEBUG - メッセージの解析結果: {'success': True, 'operation_type': 'update', 'title': None, 'location': None, 'person': None, 'recurrence': None, 'start_time': datetime.datetime(2025, 5, 14, 9, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'end_time': datetime.datetime(2025, 5, 14, 10, 0, tzinfo=datetime.timezone(datetime.timedelta(seconds=32400))), 'date_only': False, 'delete_index': None}
2025-05-10 11:27:24,766 - calendar_operations - INFO - Google Calendar APIサービスを初期化しました（OAuth認証）
2025-05-10 11:27:24,766 - calendar_operations - INFO - カレンダーIDの取得を開始します
2025-05-10 11:27:24,767 - googleapiclient.discovery - DEBUG - URL being requested: GET https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json
2025-05-10 11:27:24,767 - google_auth_httplib2 - DEBUG - Making request: POST https://oauth2.googleapis.com/token
2025-05-10 11:27:25,515 - calendar_operations - INFO - 利用可能なカレンダー数: 3
2025-05-10 11:27:25,516 - calendar_operations - INFO - カレンダー詳細: ID=mmms.dy.23@gmail.com, タイトル=mmms.dy.23@gmail.com, プライマリー=True, アクセス権限=owner
2025-05-10 11:27:25,517 - calendar_operations - INFO - プライマリーカレンダーを使用: mmms.dy.23@gmail.com
2025-05-10 11:27:25,517 - __main__ - WARNING - 未対応の操作タイプ: update
2025-05-10 11:27:25,518 - __main__ - DEBUG - LINEへの返信を開始: すみません、その操作はまだ実装されていません。
2025-05-10 11:27:25,519 - __main__ - DEBUG - 送信するメッセージ: [TextMessage(type='text', quick_reply=None, sender=None, text='すみません、その操作はまだ実装されていません。', emojis=None, quote_token=None)]
2025-05-10 11:27:25,651 - __main__ - DEBUG - LINEへの返信が完了
2025-05-10 11:27:25,652 - __main__ - INFO - Webhookの処理が完了
2025-05-10 11:27:25,652 - __main__ - INFO - Request processed in 0.90 seconds
2025-05-10 11:27:25,653 - __main__ - DEBUG - Response status: 200 OK
2025-05-10 11:27:25,653 - __main__ - DEBUG - Response headers: {'Content-Type': 'text/html; charset=utf-8', 'Content-Length': '2'}
2025-05-10 11:27:25,653 - werkzeug - INFO - 147.92.149.169 - - [10/May/2025 11:27:25] "POST /callback HTTP/1.1" 200 -
